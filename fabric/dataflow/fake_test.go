// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License. See LICENSE in the project root for license information.
// Code generated by Microsoft (R) AutoRest Code Generator.
// Changes may cause incorrect behavior and will be lost if the code is regenerated.
// SPDX-License-Identifier: MIT

package dataflow_test

import (
	"context"
	"net/http"
	"testing"

	"github.com/Azure/azure-sdk-for-go/sdk/azcore"

	azfake "github.com/Azure/azure-sdk-for-go/sdk/azcore/fake"
	"github.com/Azure/azure-sdk-for-go/sdk/azcore/runtime"
	"github.com/Azure/azure-sdk-for-go/sdk/azcore/to"

	"reflect"
	"time"

	"github.com/stretchr/testify/suite"

	"github.com/microsoft/fabric-sdk-go/fabric"
	"github.com/microsoft/fabric-sdk-go/fabric/dataflow"
	"github.com/microsoft/fabric-sdk-go/fabric/dataflow/fake"
)

var err error

type FakeTestSuite struct {
	suite.Suite

	ctx  context.Context
	cred azcore.TokenCredential

	serverFactory *fake.ServerFactory
	clientFactory *dataflow.ClientFactory
}

func (testsuite *FakeTestSuite) SetupSuite() {
	testsuite.ctx = context.Background()
	testsuite.cred = &azfake.TokenCredential{}

	testsuite.serverFactory = &fake.ServerFactory{}
	testsuite.clientFactory, err = dataflow.NewClientFactory(testsuite.cred, nil, &fabric.ClientOptions{
		ClientOptions: azcore.ClientOptions{
			Transport: fake.NewServerFactoryTransport(testsuite.serverFactory),
		},
	})
	testsuite.Require().NoError(err, "Failed to create client factory")
}

func TestFakeTest(t *testing.T) {
	suite.Run(t, new(FakeTestSuite))
}

func (testsuite *FakeTestSuite) TestItems_ListDataflows() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"List Dataflows in workspace example"},
	})
	var exampleWorkspaceID string
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"

	exampleRes := dataflow.Dataflows{
		Value: []dataflow.Dataflow{
			{
				Type:        to.Ptr(dataflow.ItemTypeDataflow),
				Description: to.Ptr("A Dataflow description."),
				DisplayName: to.Ptr("TestDataflow"),
				ID:          to.Ptr("3546052c-ae64-4526-b1a8-52af7761426f"),
				WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
			},
			{
				Type:        to.Ptr(dataflow.ItemTypeDataflow),
				Description: to.Ptr("A Dataflow description."),
				DisplayName: to.Ptr("TestDataflow"),
				ID:          to.Ptr("f697fb63-abd4-4399-9548-be7e3c3c0dac"),
				WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
			}},
	}

	testsuite.serverFactory.ItemsServer.NewListDataflowsPager = func(workspaceID string, options *dataflow.ItemsClientListDataflowsOptions) (resp azfake.PagerResponder[dataflow.ItemsClientListDataflowsResponse]) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		resp = azfake.PagerResponder[dataflow.ItemsClientListDataflowsResponse]{}
		resp.AddPage(http.StatusOK, dataflow.ItemsClientListDataflowsResponse{Dataflows: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	pager := client.NewListDataflowsPager(exampleWorkspaceID, &dataflow.ItemsClientListDataflowsOptions{ContinuationToken: nil})
	for pager.More() {
		nextResult, err := pager.NextPage(ctx)
		testsuite.Require().NoError(err, "Failed to advance page for example ")
		testsuite.Require().True(reflect.DeepEqual(exampleRes, nextResult.Dataflows))
		if err == nil {
			break
		}
	}
}

func (testsuite *FakeTestSuite) TestItems_CreateDataflow() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Create a Dataflow example"},
	})
	var exampleWorkspaceID string
	var exampleCreateDataflowRequest dataflow.CreateDataflowRequest
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleCreateDataflowRequest = dataflow.CreateDataflowRequest{
		Description: to.Ptr("A Dataflow description."),
		DisplayName: to.Ptr("TestDataflow"),
	}

	testsuite.serverFactory.ItemsServer.BeginCreateDataflow = func(ctx context.Context, workspaceID string, createDataflowRequest dataflow.CreateDataflowRequest, options *dataflow.ItemsClientBeginCreateDataflowOptions) (resp azfake.PollerResponder[dataflow.ItemsClientCreateDataflowResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().True(reflect.DeepEqual(exampleCreateDataflowRequest, createDataflowRequest))
		resp = azfake.PollerResponder[dataflow.ItemsClientCreateDataflowResponse]{}
		resp.SetTerminalResponse(http.StatusCreated, dataflow.ItemsClientCreateDataflowResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	poller, err := client.BeginCreateDataflow(ctx, exampleWorkspaceID, exampleCreateDataflowRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	_, err = poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")

	// From example
	ctx = runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Create a Dataflow with public definition example"},
	})
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleCreateDataflowRequest = dataflow.CreateDataflowRequest{
		Description: to.Ptr("A Dataflow description."),
		Definition: &dataflow.Definition{
			Parts: []dataflow.DefinitionPart{
				{
					Path:        to.Ptr("queryMetadata.json"),
					Payload:     to.Ptr("ewogICJmb3JtYXRWZXJzaW9uIjogIjIwMjUwMiIsCiAgImNvbXB1dGVFbmdpbmVTZXR0aW5ncyI6IHt9LAogICJuYW1lIjogIlRlc3REYXRhZmxvdyIsCiAgInF1ZXJ5R3JvdXBzIjogW10sCiAgImRvY3VtZW50TG9jYWxlIjogImVuLVVTIiwKICAicXVlcmllc01ldGFkYXRhIjogewogICAgInF1ZXJ5IjogewogICAgICAicXVlcnlJZCI6ICJiZTE3MjEwZi01YWNhLTQyMWEtOGMwYS1iZjYzMTQ4N2JiOGUiLAogICAgICAicXVlcnlOYW1lIjogIlF1ZXJ5IgogICAgfQogIH0sCiAgImNvbm5lY3Rpb25zIjogW10KfQ=="),
					PayloadType: to.Ptr(dataflow.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("mashup.pq"),
					Payload:     to.Ptr("W1N0YWdpbmdEZWZpbml0aW9uID0gW0tpbmQgPSAiRmFzdENvcHkiXV0Kc2VjdGlvbiBTZWN0aW9uMTsKc2hhcmVkIFF1ZXJ5ID0gbGV0CiAgU291cmNlID0gVGFibGUuRnJvbVJvd3MoSnNvbi5Eb2N1bWVudChCaW5hcnkuRGVjb21wcmVzcyhCaW5hcnkuRnJvbVRleHQoImk0NVdNbFRTVVhMT3p5bk56VE9LUjdDTmdleFluV2dsSXlSWkl5UlpJNlhZV0FBPSIsIEJpbmFyeUVuY29kaW5nLkJhc2U2NCksIENvbXByZXNzaW9uLkRlZmxhdGUpKSwgbGV0IF90ID0gKCh0eXBlIG51bGxhYmxlIHRleHQpIG1ldGEgW1NlcmlhbGl6ZWQuVGV4dCA9IHRydWVdKSBpbiB0eXBlIHRhYmxlIFtDb2x1bW4xID0gX3QsIENvbHVtbjIgPSBfdCwgQ29sdW1uMyA9IF90XSksCiAgIyJDaGFuZ2VkIGNvbHVtbiB0eXBlIiA9IFRhYmxlLlRyYW5zZm9ybUNvbHVtblR5cGVzKFNvdXJjZSwge3siQ29sdW1uMSIsIEludDY0LlR5cGV9LCB7IkNvbHVtbjIiLCB0eXBlIHRleHR9LCB7IkNvbHVtbjMiLCB0eXBlIHRleHR9fSkKaW4KICAjIkNoYW5nZWQgY29sdW1uIHR5cGUiOwo="),
					PayloadType: to.Ptr(dataflow.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr(".platform"),
					Payload:     to.Ptr("ewogICIkc2NoZW1hIjogImh0dHBzOi8vZGV2ZWxvcGVyLm1pY3Jvc29mdC5jb20vanNvbi1zY2hlbWFzL2ZhYnJpYy9naXRJbnRlZ3JhdGlvbi9wbGF0Zm9ybVByb3BlcnRpZXMvMi4wLjAvc2NoZW1hLmpzb24iLAogICJtZXRhZGF0YSI6IHsKICAgICJ0eXBlIjogIkRhdGFmbG93IiwKICAgICJkaXNwbGF5TmFtZSI6ICJUZXN0RGF0YWZsb3ciCiAgfSwKICAiY29uZmlnIjogewogICAgInZlcnNpb24iOiAiMi4wIiwKICAgICJsb2dpY2FsSWQiOiAiZjU4ZDJmODMtYTMwMC1iMTM1LTQ3ODgtMDU5NjgzY2Q1NzFjIgogIH0KfQ=="),
					PayloadType: to.Ptr(dataflow.PayloadTypeInlineBase64),
				}},
		},
		DisplayName: to.Ptr("TestDataflow"),
	}

	testsuite.serverFactory.ItemsServer.BeginCreateDataflow = func(ctx context.Context, workspaceID string, createDataflowRequest dataflow.CreateDataflowRequest, options *dataflow.ItemsClientBeginCreateDataflowOptions) (resp azfake.PollerResponder[dataflow.ItemsClientCreateDataflowResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().True(reflect.DeepEqual(exampleCreateDataflowRequest, createDataflowRequest))
		resp = azfake.PollerResponder[dataflow.ItemsClientCreateDataflowResponse]{}
		resp.SetTerminalResponse(http.StatusCreated, dataflow.ItemsClientCreateDataflowResponse{}, nil)
		return
	}

	poller, err = client.BeginCreateDataflow(ctx, exampleWorkspaceID, exampleCreateDataflowRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	_, err = poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")
}

func (testsuite *FakeTestSuite) TestItems_GetDataflow() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get a Dataflow example"},
	})
	var exampleWorkspaceID string
	var exampleDataflowID string
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleDataflowID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"

	exampleRes := dataflow.Dataflow{
		Type:        to.Ptr(dataflow.ItemTypeDataflow),
		Description: to.Ptr("A Dataflow description."),
		DisplayName: to.Ptr("TestDataflow"),
		ID:          to.Ptr("5b218778-e7a5-4d73-8187-f10824047715"),
		WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
	}

	testsuite.serverFactory.ItemsServer.GetDataflow = func(ctx context.Context, workspaceID string, dataflowID string, options *dataflow.ItemsClientGetDataflowOptions) (resp azfake.Responder[dataflow.ItemsClientGetDataflowResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleDataflowID, dataflowID)
		resp = azfake.Responder[dataflow.ItemsClientGetDataflowResponse]{}
		resp.SetResponse(http.StatusOK, dataflow.ItemsClientGetDataflowResponse{Dataflow: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	res, err := client.GetDataflow(ctx, exampleWorkspaceID, exampleDataflowID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.Dataflow))
}

func (testsuite *FakeTestSuite) TestItems_UpdateDataflow() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Update a Dataflow example"},
	})
	var exampleWorkspaceID string
	var exampleDataflowID string
	var exampleUpdateDataflowRequest dataflow.UpdateDataflowRequest
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleDataflowID = "5b218778-e7a5-4d73-8187-f10824047715"
	exampleUpdateDataflowRequest = dataflow.UpdateDataflowRequest{
		Description: to.Ptr("Dataflow's New description"),
		DisplayName: to.Ptr("Dataflow's New name"),
	}

	exampleRes := dataflow.Dataflow{
		Type:        to.Ptr(dataflow.ItemTypeDataflow),
		Description: to.Ptr("Dataflow's New description"),
		DisplayName: to.Ptr("Dataflow's New name"),
		ID:          to.Ptr("5b218778-e7a5-4d73-8187-f10824047715"),
		WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
	}

	testsuite.serverFactory.ItemsServer.UpdateDataflow = func(ctx context.Context, workspaceID string, dataflowID string, updateDataflowRequest dataflow.UpdateDataflowRequest, options *dataflow.ItemsClientUpdateDataflowOptions) (resp azfake.Responder[dataflow.ItemsClientUpdateDataflowResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleDataflowID, dataflowID)
		testsuite.Require().True(reflect.DeepEqual(exampleUpdateDataflowRequest, updateDataflowRequest))
		resp = azfake.Responder[dataflow.ItemsClientUpdateDataflowResponse]{}
		resp.SetResponse(http.StatusOK, dataflow.ItemsClientUpdateDataflowResponse{Dataflow: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	res, err := client.UpdateDataflow(ctx, exampleWorkspaceID, exampleDataflowID, exampleUpdateDataflowRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.Dataflow))
}

func (testsuite *FakeTestSuite) TestItems_DeleteDataflow() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Delete a Dataflow example"},
	})
	var exampleWorkspaceID string
	var exampleDataflowID string
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleDataflowID = "5b218778-e7a5-4d73-8187-f10824047715"

	testsuite.serverFactory.ItemsServer.DeleteDataflow = func(ctx context.Context, workspaceID string, dataflowID string, options *dataflow.ItemsClientDeleteDataflowOptions) (resp azfake.Responder[dataflow.ItemsClientDeleteDataflowResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleDataflowID, dataflowID)
		resp = azfake.Responder[dataflow.ItemsClientDeleteDataflowResponse]{}
		resp.SetResponse(http.StatusOK, dataflow.ItemsClientDeleteDataflowResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	_, err = client.DeleteDataflow(ctx, exampleWorkspaceID, exampleDataflowID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestItems_GetDataflowDefinition() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get a Dataflow public definition example"},
	})
	var exampleWorkspaceID string
	var exampleDataflowID string
	exampleWorkspaceID = "6e335e92-a2a2-4b5a-970a-bd6a89fbb765"
	exampleDataflowID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"

	exampleRes := dataflow.DefinitionResponse{
		Definition: &dataflow.Definition{
			Parts: []dataflow.DefinitionPart{
				{
					Path:        to.Ptr("queryMetadata.json"),
					Payload:     to.Ptr("ewogICJmb3JtYXRWZXJzaW9uIjogIjIwMjUwMiIsCiAgImNvbXB1dGVFbmdpbmVTZXR0aW5ncyI6IHt9LAogICJuYW1lIjogIlRlc3REYXRhZmxvdyIsCiAgInF1ZXJ5R3JvdXBzIjogW10sCiAgImRvY3VtZW50TG9jYWxlIjogImVuLVVTIiwKICAicXVlcmllc01ldGFkYXRhIjogewogICAgInF1ZXJ5IjogewogICAgICAicXVlcnlJZCI6ICJiZTE3MjEwZi01YWNhLTQyMWEtOGMwYS1iZjYzMTQ4N2JiOGUiLAogICAgICAicXVlcnlOYW1lIjogIlF1ZXJ5IgogICAgfQogIH0sCiAgImNvbm5lY3Rpb25zIjogW10KfQ=="),
					PayloadType: to.Ptr(dataflow.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("mashup.pq"),
					Payload:     to.Ptr("W1N0YWdpbmdEZWZpbml0aW9uID0gW0tpbmQgPSAiRmFzdENvcHkiXV0Kc2VjdGlvbiBTZWN0aW9uMTsKc2hhcmVkIFF1ZXJ5ID0gbGV0CiAgU291cmNlID0gVGFibGUuRnJvbVJvd3MoSnNvbi5Eb2N1bWVudChCaW5hcnkuRGVjb21wcmVzcyhCaW5hcnkuRnJvbVRleHQoImk0NVdNbFRTVVhMT3p5bk56VE9LUjdDTmdleFluV2dsSXlSWkl5UlpJNlhZV0FBPSIsIEJpbmFyeUVuY29kaW5nLkJhc2U2NCksIENvbXByZXNzaW9uLkRlZmxhdGUpKSwgbGV0IF90ID0gKCh0eXBlIG51bGxhYmxlIHRleHQpIG1ldGEgW1NlcmlhbGl6ZWQuVGV4dCA9IHRydWVdKSBpbiB0eXBlIHRhYmxlIFtDb2x1bW4xID0gX3QsIENvbHVtbjIgPSBfdCwgQ29sdW1uMyA9IF90XSksCiAgIyJDaGFuZ2VkIGNvbHVtbiB0eXBlIiA9IFRhYmxlLlRyYW5zZm9ybUNvbHVtblR5cGVzKFNvdXJjZSwge3siQ29sdW1uMSIsIEludDY0LlR5cGV9LCB7IkNvbHVtbjIiLCB0eXBlIHRleHR9LCB7IkNvbHVtbjMiLCB0eXBlIHRleHR9fSkKaW4KICAjIkNoYW5nZWQgY29sdW1uIHR5cGUiOwo="),
					PayloadType: to.Ptr(dataflow.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr(".platform"),
					Payload:     to.Ptr("ewogICIkc2NoZW1hIjogImh0dHBzOi8vZGV2ZWxvcGVyLm1pY3Jvc29mdC5jb20vanNvbi1zY2hlbWFzL2ZhYnJpYy9naXRJbnRlZ3JhdGlvbi9wbGF0Zm9ybVByb3BlcnRpZXMvMi4wLjAvc2NoZW1hLmpzb24iLAogICJtZXRhZGF0YSI6IHsKICAgICJ0eXBlIjogIkRhdGFmbG93IiwKICAgICJkaXNwbGF5TmFtZSI6ICJUZXN0RGF0YWZsb3ciCiAgfSwKICAiY29uZmlnIjogewogICAgInZlcnNpb24iOiAiMi4wIiwKICAgICJsb2dpY2FsSWQiOiAiZjU4ZDJmODMtYTMwMC1iMTM1LTQ3ODgtMDU5NjgzY2Q1NzFjIgogIH0KfQ=="),
					PayloadType: to.Ptr(dataflow.PayloadTypeInlineBase64),
				}},
		},
	}

	testsuite.serverFactory.ItemsServer.BeginGetDataflowDefinition = func(ctx context.Context, workspaceID string, dataflowID string, options *dataflow.ItemsClientBeginGetDataflowDefinitionOptions) (resp azfake.PollerResponder[dataflow.ItemsClientGetDataflowDefinitionResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleDataflowID, dataflowID)
		resp = azfake.PollerResponder[dataflow.ItemsClientGetDataflowDefinitionResponse]{}
		resp.SetTerminalResponse(http.StatusOK, dataflow.ItemsClientGetDataflowDefinitionResponse{DefinitionResponse: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	poller, err := client.BeginGetDataflowDefinition(ctx, exampleWorkspaceID, exampleDataflowID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	res, err := poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.DefinitionResponse))
}

func (testsuite *FakeTestSuite) TestItems_UpdateDataflowDefinition() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Update a Dataflow public definition example"},
	})
	var exampleWorkspaceID string
	var exampleDataflowID string
	var exampleUpdateDataflowDefinitionRequest dataflow.UpdateDataflowDefinitionRequest
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleDataflowID = "5b218778-e7a5-4d73-8187-f10824047715"
	exampleUpdateDataflowDefinitionRequest = dataflow.UpdateDataflowDefinitionRequest{
		Definition: &dataflow.Definition{
			Parts: []dataflow.DefinitionPart{
				{
					Path:        to.Ptr("queryMetadata.json"),
					Payload:     to.Ptr("ewogICJmb3JtYXRWZXJzaW9uIjogIjIwMjUwMiIsCiAgImNvbXB1dGVFbmdpbmVTZXR0aW5ncyI6IHt9LAogICJuYW1lIjogIlRlc3REYXRhZmxvdyIsCiAgInF1ZXJ5R3JvdXBzIjogW10sCiAgImRvY3VtZW50TG9jYWxlIjogImVuLVVTIiwKICAicXVlcmllc01ldGFkYXRhIjogewogICAgInF1ZXJ5IjogewogICAgICAicXVlcnlJZCI6ICJiZTE3MjEwZi01YWNhLTQyMWEtOGMwYS1iZjYzMTQ4N2JiOGUiLAogICAgICAicXVlcnlOYW1lIjogIlF1ZXJ5IgogICAgfQogIH0sCiAgImNvbm5lY3Rpb25zIjogW10KfQ=="),
					PayloadType: to.Ptr(dataflow.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("mashup.pq"),
					Payload:     to.Ptr("W1N0YWdpbmdEZWZpbml0aW9uID0gW0tpbmQgPSAiRmFzdENvcHkiXV0Kc2VjdGlvbiBTZWN0aW9uMTsKc2hhcmVkIFF1ZXJ5ID0gbGV0CiAgU291cmNlID0gVGFibGUuRnJvbVJvd3MoSnNvbi5Eb2N1bWVudChCaW5hcnkuRGVjb21wcmVzcyhCaW5hcnkuRnJvbVRleHQoImk0NVdNbFRTVVhMT3p5bk56VE9LUjdDTmdleFluV2dsSXlSWkl5UlpJNlhZV0FBPSIsIEJpbmFyeUVuY29kaW5nLkJhc2U2NCksIENvbXByZXNzaW9uLkRlZmxhdGUpKSwgbGV0IF90ID0gKCh0eXBlIG51bGxhYmxlIHRleHQpIG1ldGEgW1NlcmlhbGl6ZWQuVGV4dCA9IHRydWVdKSBpbiB0eXBlIHRhYmxlIFtDb2x1bW4xID0gX3QsIENvbHVtbjIgPSBfdCwgQ29sdW1uMyA9IF90XSksCiAgIyJDaGFuZ2VkIGNvbHVtbiB0eXBlIiA9IFRhYmxlLlRyYW5zZm9ybUNvbHVtblR5cGVzKFNvdXJjZSwge3siQ29sdW1uMSIsIEludDY0LlR5cGV9LCB7IkNvbHVtbjIiLCB0eXBlIHRleHR9LCB7IkNvbHVtbjMiLCB0eXBlIHRleHR9fSkKaW4KICAjIkNoYW5nZWQgY29sdW1uIHR5cGUiOwo="),
					PayloadType: to.Ptr(dataflow.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr(".platform"),
					Payload:     to.Ptr("ewogICIkc2NoZW1hIjogImh0dHBzOi8vZGV2ZWxvcGVyLm1pY3Jvc29mdC5jb20vanNvbi1zY2hlbWFzL2ZhYnJpYy9naXRJbnRlZ3JhdGlvbi9wbGF0Zm9ybVByb3BlcnRpZXMvMi4wLjAvc2NoZW1hLmpzb24iLAogICJtZXRhZGF0YSI6IHsKICAgICJ0eXBlIjogIkRhdGFmbG93IiwKICAgICJkaXNwbGF5TmFtZSI6ICJUZXN0RGF0YWZsb3ciCiAgfSwKICAiY29uZmlnIjogewogICAgInZlcnNpb24iOiAiMi4wIiwKICAgICJsb2dpY2FsSWQiOiAiZjU4ZDJmODMtYTMwMC1iMTM1LTQ3ODgtMDU5NjgzY2Q1NzFjIgogIH0KfQ=="),
					PayloadType: to.Ptr(dataflow.PayloadTypeInlineBase64),
				}},
		},
	}

	testsuite.serverFactory.ItemsServer.BeginUpdateDataflowDefinition = func(ctx context.Context, workspaceID string, dataflowID string, updateDataflowDefinitionRequest dataflow.UpdateDataflowDefinitionRequest, options *dataflow.ItemsClientBeginUpdateDataflowDefinitionOptions) (resp azfake.PollerResponder[dataflow.ItemsClientUpdateDataflowDefinitionResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleDataflowID, dataflowID)
		testsuite.Require().True(reflect.DeepEqual(exampleUpdateDataflowDefinitionRequest, updateDataflowDefinitionRequest))
		resp = azfake.PollerResponder[dataflow.ItemsClientUpdateDataflowDefinitionResponse]{}
		resp.SetTerminalResponse(http.StatusOK, dataflow.ItemsClientUpdateDataflowDefinitionResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	poller, err := client.BeginUpdateDataflowDefinition(ctx, exampleWorkspaceID, exampleDataflowID, exampleUpdateDataflowDefinitionRequest, &dataflow.ItemsClientBeginUpdateDataflowDefinitionOptions{UpdateMetadata: to.Ptr(true)})
	testsuite.Require().NoError(err, "Failed to get result for example ")
	_, err = poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")
}

func (testsuite *FakeTestSuite) TestItems_DiscoverDataflowParameters() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get Dataflow Parameters example"},
	})
	var exampleWorkspaceID string
	var exampleDataflowID string
	exampleWorkspaceID = "a0a0a0a0-bbbb-cccc-dddd-e1e1e1e1e1e1"
	exampleDataflowID = "dddddddd-9999-0000-1111-eeeeeeeeeeee"

	exampleRes := dataflow.Parameters{
		Value: []dataflow.ParameterClassification{
			&dataflow.StringParameter{
				Name:         to.Ptr("manufacturer"),
				Type:         to.Ptr(dataflow.ParameterTypeString),
				Description:  to.Ptr("Manufacturer of the item"),
				IsRequired:   to.Ptr(true),
				DefaultValue: to.Ptr("test-value"),
			},
			&dataflow.BooleanParameter{
				Name:         to.Ptr("isImported"),
				Type:         to.Ptr(dataflow.ParameterTypeBoolean),
				Description:  to.Ptr("Is the item imported"),
				IsRequired:   to.Ptr(false),
				DefaultValue: to.Ptr(true),
			},
			&dataflow.IntegerParameter{
				Name:         to.Ptr("quantity"),
				Type:         to.Ptr(dataflow.ParameterTypeInteger),
				Description:  to.Ptr("Quantity of item"),
				IsRequired:   to.Ptr(false),
				DefaultValue: to.Ptr[int64](123456789),
			},
			&dataflow.NumberParameter{
				Name:         to.Ptr("weightThreshold"),
				Type:         to.Ptr(dataflow.ParameterTypeNumber),
				Description:  to.Ptr("Weight threshold for item"),
				IsRequired:   to.Ptr(true),
				DefaultValue: to.Ptr[float64](3.14),
			},
			&dataflow.DateTimeParameter{
				Name:         to.Ptr("datetimeOfOrder"),
				Type:         to.Ptr(dataflow.ParameterTypeDateTime),
				Description:  to.Ptr("Datetime of order"),
				IsRequired:   to.Ptr(true),
				DefaultValue: to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-09-15T21:45:00.000Z"); return t }()),
			},
			&dataflow.DateTimeZoneParameter{
				Name:         to.Ptr("datetimeZoneOfOrder"),
				Type:         to.Ptr(dataflow.ParameterTypeDateTimeZone),
				Description:  to.Ptr("DatetimeZone of order"),
				IsRequired:   to.Ptr(true),
				DefaultValue: to.Ptr("2025-09-15T21:45:00+02:00"),
			},
			&dataflow.DateParameter{
				Name:         to.Ptr("dateOfImport"),
				Type:         to.Ptr(dataflow.ParameterTypeDate),
				Description:  to.Ptr("Date of import"),
				IsRequired:   to.Ptr(true),
				DefaultValue: to.Ptr("2025-09-15"),
			},
			&dataflow.TimeParameter{
				Name:         to.Ptr("timeOfImport"),
				Type:         to.Ptr(dataflow.ParameterTypeTime),
				Description:  to.Ptr("Time of import"),
				IsRequired:   to.Ptr(true),
				DefaultValue: to.Ptr("21:45:00"),
			},
			&dataflow.DurationParameter{
				Name:         to.Ptr("durationOfImport"),
				Type:         to.Ptr(dataflow.ParameterTypeDuration),
				Description:  to.Ptr("Duration of import"),
				IsRequired:   to.Ptr(true),
				DefaultValue: to.Ptr("P5DT21H35M30S"),
			}},
	}

	testsuite.serverFactory.ItemsServer.NewDiscoverDataflowParametersPager = func(workspaceID string, dataflowID string, options *dataflow.ItemsClientDiscoverDataflowParametersOptions) (resp azfake.PagerResponder[dataflow.ItemsClientDiscoverDataflowParametersResponse]) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleDataflowID, dataflowID)
		resp = azfake.PagerResponder[dataflow.ItemsClientDiscoverDataflowParametersResponse]{}
		resp.AddPage(http.StatusOK, dataflow.ItemsClientDiscoverDataflowParametersResponse{Parameters: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	pager := client.NewDiscoverDataflowParametersPager(exampleWorkspaceID, exampleDataflowID, &dataflow.ItemsClientDiscoverDataflowParametersOptions{ContinuationToken: nil})
	for pager.More() {
		nextResult, err := pager.NextPage(ctx)
		testsuite.Require().NoError(err, "Failed to advance page for example ")
		testsuite.Require().True(reflect.DeepEqual(exampleRes, nextResult.Parameters))
		if err == nil {
			break
		}
	}
}

func (testsuite *FakeTestSuite) TestBackgroundJobs_ScheduleExecute() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Create dataflow Execute schedule example"},
	})
	var exampleWorkspaceID string
	var exampleDataflowID string
	var exampleCreateScheduleRequest dataflow.CreateDataflowExecuteScheduleRequest
	exampleWorkspaceID = "a0a0a0a0-bbbb-cccc-dddd-e1e1e1e1e1e1"
	exampleDataflowID = "dddddddd-9999-0000-1111-eeeeeeeeeeee"
	exampleCreateScheduleRequest = dataflow.CreateDataflowExecuteScheduleRequest{
		Configuration: &dataflow.CronScheduleConfig{
			Type:            to.Ptr(dataflow.ScheduleTypeCron),
			EndDateTime:     to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-04-30T23:59:00.000Z"); return t }()),
			LocalTimeZoneID: to.Ptr("Central Standard Time"),
			StartDateTime:   to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-04-28T00:00:00.000Z"); return t }()),
			Interval:        to.Ptr[int32](10),
		},
		Enabled: to.Ptr(true),
	}

	testsuite.serverFactory.BackgroundJobsServer.ScheduleExecute = func(ctx context.Context, workspaceID string, dataflowID string, createScheduleRequest dataflow.CreateDataflowExecuteScheduleRequest, options *dataflow.BackgroundJobsClientScheduleExecuteOptions) (resp azfake.Responder[dataflow.BackgroundJobsClientScheduleExecuteResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleDataflowID, dataflowID)
		testsuite.Require().True(reflect.DeepEqual(exampleCreateScheduleRequest, createScheduleRequest))
		resp = azfake.Responder[dataflow.BackgroundJobsClientScheduleExecuteResponse]{}
		resp.SetResponse(http.StatusCreated, dataflow.BackgroundJobsClientScheduleExecuteResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewBackgroundJobsClient()
	_, err = client.ScheduleExecute(ctx, exampleWorkspaceID, exampleDataflowID, exampleCreateScheduleRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestBackgroundJobs_ScheduleApplyChanges() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Create dataflow ApplyChanges schedule example"},
	})
	var exampleWorkspaceID string
	var exampleDataflowID string
	var exampleCreateScheduleRequest dataflow.CreateDataflowApplyChangesScheduleRequest
	exampleWorkspaceID = "a0a0a0a0-bbbb-cccc-dddd-e1e1e1e1e1e1"
	exampleDataflowID = "dddddddd-9999-0000-1111-eeeeeeeeeeee"
	exampleCreateScheduleRequest = dataflow.CreateDataflowApplyChangesScheduleRequest{
		Configuration: &dataflow.CronScheduleConfig{
			Type:            to.Ptr(dataflow.ScheduleTypeCron),
			EndDateTime:     to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-04-30T23:59:00.000Z"); return t }()),
			LocalTimeZoneID: to.Ptr("Central Standard Time"),
			StartDateTime:   to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-04-28T00:00:00.000Z"); return t }()),
			Interval:        to.Ptr[int32](10),
		},
		Enabled: to.Ptr(true),
	}

	testsuite.serverFactory.BackgroundJobsServer.ScheduleApplyChanges = func(ctx context.Context, workspaceID string, dataflowID string, createScheduleRequest dataflow.CreateDataflowApplyChangesScheduleRequest, options *dataflow.BackgroundJobsClientScheduleApplyChangesOptions) (resp azfake.Responder[dataflow.BackgroundJobsClientScheduleApplyChangesResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleDataflowID, dataflowID)
		testsuite.Require().True(reflect.DeepEqual(exampleCreateScheduleRequest, createScheduleRequest))
		resp = azfake.Responder[dataflow.BackgroundJobsClientScheduleApplyChangesResponse]{}
		resp.SetResponse(http.StatusCreated, dataflow.BackgroundJobsClientScheduleApplyChangesResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewBackgroundJobsClient()
	_, err = client.ScheduleApplyChanges(ctx, exampleWorkspaceID, exampleDataflowID, exampleCreateScheduleRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestBackgroundJobs_RunOnDemandExecute() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Run dataflow Execute job instance with no request body example"},
	})
	var exampleWorkspaceID string
	var exampleDataflowID string
	exampleWorkspaceID = "a0a0a0a0-bbbb-cccc-dddd-e1e1e1e1e1e1"
	exampleDataflowID = "dddddddd-9999-0000-1111-eeeeeeeeeeee"

	testsuite.serverFactory.BackgroundJobsServer.RunOnDemandExecute = func(ctx context.Context, workspaceID string, dataflowID string, options *dataflow.BackgroundJobsClientRunOnDemandExecuteOptions) (resp azfake.Responder[dataflow.BackgroundJobsClientRunOnDemandExecuteResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleDataflowID, dataflowID)
		resp = azfake.Responder[dataflow.BackgroundJobsClientRunOnDemandExecuteResponse]{}
		resp.SetResponse(http.StatusAccepted, dataflow.BackgroundJobsClientRunOnDemandExecuteResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewBackgroundJobsClient()
	_, err = client.RunOnDemandExecute(ctx, exampleWorkspaceID, exampleDataflowID, &dataflow.BackgroundJobsClientRunOnDemandExecuteOptions{RunOnDemandItemJobRequest: nil})
	testsuite.Require().NoError(err, "Failed to get result for example ")

	// From example
	ctx = runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Run dataflow Execute job instance with request body containing parameters example"},
	})
	exampleWorkspaceID = "a0a0a0a0-bbbb-cccc-dddd-e1e1e1e1e1e1"
	exampleDataflowID = "dddddddd-9999-0000-1111-eeeeeeeeeeee"

	testsuite.serverFactory.BackgroundJobsServer.RunOnDemandExecute = func(ctx context.Context, workspaceID string, dataflowID string, options *dataflow.BackgroundJobsClientRunOnDemandExecuteOptions) (resp azfake.Responder[dataflow.BackgroundJobsClientRunOnDemandExecuteResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleDataflowID, dataflowID)
		resp = azfake.Responder[dataflow.BackgroundJobsClientRunOnDemandExecuteResponse]{}
		resp.SetResponse(http.StatusAccepted, dataflow.BackgroundJobsClientRunOnDemandExecuteResponse{}, nil)
		return
	}

	_, err = client.RunOnDemandExecute(ctx, exampleWorkspaceID, exampleDataflowID, &dataflow.BackgroundJobsClientRunOnDemandExecuteOptions{RunOnDemandItemJobRequest: &dataflow.RunOnDemandDataflowExecuteJobRequest{
		ExecutionData: &dataflow.ExecutionPayload{
			ExecuteOption: to.Ptr(dataflow.ExecuteOptionApplyChangesIfNeeded),
			Parameters: []dataflow.ItemJobParameter{
				{
					Type:          to.Ptr(dataflow.TypeAutomatic),
					ParameterName: to.Ptr("OrderKey"),
					Value:         float64(25),
				},
				{
					Type:          to.Ptr(dataflow.TypeAutomatic),
					ParameterName: to.Ptr("Threshold"),
					Value:         "start",
				}},
		},
	},
	})
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestBackgroundJobs_RunOnDemandApplyChanges() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Run dataflow ApplyChanges job instance example"},
	})
	var exampleWorkspaceID string
	var exampleDataflowID string
	exampleWorkspaceID = "a0a0a0a0-bbbb-cccc-dddd-e1e1e1e1e1e1"
	exampleDataflowID = "dddddddd-9999-0000-1111-eeeeeeeeeeee"

	testsuite.serverFactory.BackgroundJobsServer.RunOnDemandApplyChanges = func(ctx context.Context, workspaceID string, dataflowID string, options *dataflow.BackgroundJobsClientRunOnDemandApplyChangesOptions) (resp azfake.Responder[dataflow.BackgroundJobsClientRunOnDemandApplyChangesResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleDataflowID, dataflowID)
		resp = azfake.Responder[dataflow.BackgroundJobsClientRunOnDemandApplyChangesResponse]{}
		resp.SetResponse(http.StatusAccepted, dataflow.BackgroundJobsClientRunOnDemandApplyChangesResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewBackgroundJobsClient()
	_, err = client.RunOnDemandApplyChanges(ctx, exampleWorkspaceID, exampleDataflowID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestQueryExecution_ExecuteQuery() {
	testsuite.T().Skip("Warning: No test steps for this operation!")
}
