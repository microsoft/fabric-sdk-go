// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License. See LICENSE in the project root for license information.
// Code generated by Microsoft (R) AutoRest Code Generator.
// Changes may cause incorrect behavior and will be lost if the code is regenerated.
// SPDX-License-Identifier: MIT

package lakehouse_test

import (
	"context"
	"net/http"
	"testing"

	"github.com/Azure/azure-sdk-for-go/sdk/azcore"

	azfake "github.com/Azure/azure-sdk-for-go/sdk/azcore/fake"
	"github.com/Azure/azure-sdk-for-go/sdk/azcore/runtime"
	"github.com/Azure/azure-sdk-for-go/sdk/azcore/to"

	"reflect"
	"time"

	"github.com/stretchr/testify/suite"

	"github.com/microsoft/fabric-sdk-go/fabric"
	"github.com/microsoft/fabric-sdk-go/fabric/lakehouse"
	"github.com/microsoft/fabric-sdk-go/fabric/lakehouse/fake"
)

var err error

type FakeTestSuite struct {
	suite.Suite

	ctx  context.Context
	cred azcore.TokenCredential

	serverFactory *fake.ServerFactory
	clientFactory *lakehouse.ClientFactory
}

func (testsuite *FakeTestSuite) SetupSuite() {
	testsuite.ctx = context.Background()
	testsuite.cred = &azfake.TokenCredential{}

	testsuite.serverFactory = &fake.ServerFactory{}
	testsuite.clientFactory, err = lakehouse.NewClientFactory(testsuite.cred, nil, &fabric.ClientOptions{
		ClientOptions: azcore.ClientOptions{
			Transport: fake.NewServerFactoryTransport(testsuite.serverFactory),
		},
	})
	testsuite.Require().NoError(err, "Failed to create client factory")
}

func TestFakeTest(t *testing.T) {
	suite.Run(t, new(FakeTestSuite))
}

func (testsuite *FakeTestSuite) TestItems_ListLakehouses() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"List lakehouses in workspace example"},
	})
	var exampleWorkspaceID string
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"

	exampleRes := lakehouse.Lakehouses{
		Value: []lakehouse.Lakehouse{
			{
				Type:        to.Ptr(lakehouse.ItemTypeLakehouse),
				Description: to.Ptr("A lakehouse description."),
				DisplayName: to.Ptr("Lakehouse_1"),
				ID:          to.Ptr("3546052c-ae64-4526-b1a8-52af7761426f"),
				WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
				Properties: &lakehouse.Properties{
					OneLakeFilesPath:  to.Ptr("https://onelake.dfs.fabric.microsoft.com/2382cdf5-d577-44d0-a1fc-42184f29a7eb/e5fb215b-1934-413e-b33a-debaf844afde/Files"),
					OneLakeTablesPath: to.Ptr("https://onelake.dfs.fabric.microsoft.com/2382cdf5-d577-44d0-a1fc-42184f29a7eb/e5fb215b-1934-413e-b33a-debaf844afde/Tables"),
					SQLEndpointProperties: &lakehouse.SQLEndpointProperties{
						ConnectionString:   to.Ptr("qvrmbuxie7we7glrekxgy6npqu-6xgyei3x2xiejip4iime6knh5m.datawarehouse.fabric.microsoft.com"),
						ID:                 to.Ptr("37dc8a41-dea9-465d-b528-3e95043b2356"),
						ProvisioningStatus: to.Ptr(lakehouse.SQLEndpointProvisioningStatusSuccess),
					},
				},
			},
			{
				Type:        to.Ptr(lakehouse.ItemTypeLakehouse),
				Description: to.Ptr("A lakehouse description."),
				DisplayName: to.Ptr("Lakehouse_2"),
				ID:          to.Ptr("a8a1bffa-7eea-49dc-a1d2-6281c1d031f1"),
				WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
				Properties: &lakehouse.Properties{
					OneLakeFilesPath:  to.Ptr("https://onelake.dfs.fabric.microsoft.com/fc5d0537-1b22-4de1-a5e9-9b8bb58ed1e1/6dc325f6-46f6-4a2a-930b-10b96a463566/Files"),
					OneLakeTablesPath: to.Ptr("https://onelake.dfs.fabric.microsoft.com/fc5d0537-1b22-4de1-a5e9-9b8bb58ed1e1/6dc325f6-46f6-4a2a-930b-10b96a463566/Tables"),
					SQLEndpointProperties: &lakehouse.SQLEndpointProperties{
						ConnectionString:   to.Ptr("qvrmbuxie7we7glrekxgy6npqu-6xgyei3x2xiejip4iime6knh5m.datawarehouse.fabric.microsoft.com"),
						ID:                 to.Ptr("37dc8a41-dea9-465d-b528-3e95043b2356"),
						ProvisioningStatus: to.Ptr(lakehouse.SQLEndpointProvisioningStatusSuccess),
					},
				},
			}},
	}

	testsuite.serverFactory.ItemsServer.NewListLakehousesPager = func(workspaceID string, options *lakehouse.ItemsClientListLakehousesOptions) (resp azfake.PagerResponder[lakehouse.ItemsClientListLakehousesResponse]) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		resp = azfake.PagerResponder[lakehouse.ItemsClientListLakehousesResponse]{}
		resp.AddPage(http.StatusOK, lakehouse.ItemsClientListLakehousesResponse{Lakehouses: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	pager := client.NewListLakehousesPager(exampleWorkspaceID, &lakehouse.ItemsClientListLakehousesOptions{ContinuationToken: nil})
	for pager.More() {
		nextResult, err := pager.NextPage(ctx)
		testsuite.Require().NoError(err, "Failed to advance page for example ")
		testsuite.Require().True(reflect.DeepEqual(exampleRes, nextResult.Lakehouses))
		if err == nil {
			break
		}
	}
}

func (testsuite *FakeTestSuite) TestItems_CreateLakehouse() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Create a lakehouse example"},
	})
	var exampleWorkspaceID string
	var exampleCreateLakehouseRequest lakehouse.CreateLakehouseRequest
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleCreateLakehouseRequest = lakehouse.CreateLakehouseRequest{
		Description: to.Ptr("A lakehouse description"),
		DisplayName: to.Ptr("Lakehouse_1"),
	}

	testsuite.serverFactory.ItemsServer.BeginCreateLakehouse = func(ctx context.Context, workspaceID string, createLakehouseRequest lakehouse.CreateLakehouseRequest, options *lakehouse.ItemsClientBeginCreateLakehouseOptions) (resp azfake.PollerResponder[lakehouse.ItemsClientCreateLakehouseResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().True(reflect.DeepEqual(exampleCreateLakehouseRequest, createLakehouseRequest))
		resp = azfake.PollerResponder[lakehouse.ItemsClientCreateLakehouseResponse]{}
		resp.SetTerminalResponse(http.StatusCreated, lakehouse.ItemsClientCreateLakehouseResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	poller, err := client.BeginCreateLakehouse(ctx, exampleWorkspaceID, exampleCreateLakehouseRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	_, err = poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")

	// From example
	ctx = runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Create a lakehouse with definition example"},
	})
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleCreateLakehouseRequest = lakehouse.CreateLakehouseRequest{
		Description: to.Ptr("Example lakehouse with definition"),
		Definition: &lakehouse.Definition{
			Format: to.Ptr("LakehouseDefinitionV1"),
			Parts: []lakehouse.DefinitionPart{
				{
					Path:        to.Ptr("lakehouse.metadata.json"),
					Payload:     to.Ptr("eyJkZWZhdWx0U2NoZW1hIjoiZGJvIn0="),
					PayloadType: to.Ptr(lakehouse.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("shortcuts.metadata.json"),
					Payload:     to.Ptr("WwogIHsKICAgICJuYW1lIjogIk55Y1RheGkiLAogICAgInBhdGgiOiAiL1RhYmxlcyIsCiAgICAidGFyZ2V0IjogewogICAgICAidHlwZSI6ICJPbmVMYWtlIiwKICAgICAgIm9uZUxha2UiOiB7CiAgICAgICAgInBhdGgiOiAiRmlsZXMvTnljVGF4aSIsCiAgICAgICAgIml0ZW1JZCI6ICIxNzBjYzY3Ni1hYzFhLTkwNmUtNDE5Mi0zZGJlZGM1MmYwMWUiLAogICAgICAgICJ3b3Jrc3BhY2VJZCI6ICJjZmFmYmViMS04MDM3LTRkMGMtODk2ZS1hNDZmYjI3ZmYyMjkiLAogICAgICAgICJhcnRpZmFjdFR5cGUiOiAiTGFrZWhvdXNlIgogICAgICB9CiAgICB9CiAgfQpd"),
					PayloadType: to.Ptr(lakehouse.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("data-access-roles.json"),
					Payload:     to.Ptr("Ww0KICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgIm5hbWUiOiAiZGltZW5zaW9ucnVsZXJlbmFtZSIsDQogICAgICAgICAgICAgICAgImtpbmQiOiAiUG9saWN5IiwNCiAgICAgICAgICAgICAgICAiZGVjaXNpb25SdWxlcyI6IFsNCiAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgImVmZmVjdCI6ICJQZXJtaXQiLA0KICAgICAgICAgICAgICAgICAgICAicGVybWlzc2lvbiI6IFsNCiAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAiYXR0cmlidXRlTmFtZSI6ICJQYXRoIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJhdHRyaWJ1dGVWYWx1ZUluY2x1ZGVkSW4iOiBbDQogICAgICAgICAgICAgICAgICAgICAgICAgICIvVGFibGVzL2Riby9kaW1lbnNpb25fY2l0eSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICIvVGFibGVzL2Riby9kaW1lbnNpb25fY3VzdG9tZXIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAiL1RhYmxlcy9kYm8vZGltZW5zaW9uX2RhdGUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAiL1RhYmxlcy9kYm8vZGltZW5zaW9uX2VtcGxveWVlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIi9UYWJsZXMvZGJvL2RpbWVuc2lvbl9zdG9ja19pdGVtIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIi9UYWJsZXMvYnJvbnplIg0KICAgICAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgImF0dHJpYnV0ZU5hbWUiOiAiQWN0aW9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJhdHRyaWJ1dGVWYWx1ZUluY2x1ZGVkSW4iOiBbDQogICAgICAgICAgICAgICAgICAgICAgICAgICJSZWFkIg0KICAgICAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgXSwNCiAgICAgICAgICAgICAgICAgICAgImNvbnN0cmFpbnRzIjoge30NCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBdLA0KICAgICAgICAgICAgICAgICJtZW1iZXJzIjogew0KICAgICAgICAgICAgICAgICAgImZhYnJpY0l0ZW1NZW1iZXJzIjogW10sDQogICAgICAgICAgICAgICAgICAgICJtaWNyb3NvZnRFbnRyYU1lbWJlcnMiOiBbDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAidGVuYW50SWQiOiAiMWU4NTAwMGUtZWUzNS00MTEyLWJkNDYtMmYwMGIzZDk0MTU0IiwNCiAgICAgICAgICAgICAgICAgICAgICAib2JqZWN0SWQiOiAiNWYzZWZkMzctYTZkMi00MzJmLTk5ZmEtNmFkYzI4NDhhNDBhIg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICBdDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgIm5hbWUiOiAiRGVmYXVsdFJlYWRlciIsDQogICAgICAgICAgICAgICAgImtpbmQiOiAiUG9saWN5IiwNCiAgICAgICAgICAgICAgICAiZGVjaXNpb25SdWxlcyI6IFsNCiAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgImVmZmVjdCI6ICJQZXJtaXQiLA0KICAgICAgICAgICAgICAgICAgICAicGVybWlzc2lvbiI6IFsNCiAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAiYXR0cmlidXRlTmFtZSI6ICJBY3Rpb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgImF0dHJpYnV0ZVZhbHVlSW5jbHVkZWRJbiI6IFsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIlJlYWQiDQogICAgICAgICAgICAgICAgICAgICAgICBdDQogICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAiYXR0cmlidXRlTmFtZSI6ICJQYXRoIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJhdHRyaWJ1dGVWYWx1ZUluY2x1ZGVkSW4iOiBbDQogICAgICAgICAgICAgICAgICAgICAgICAgICIqIg0KICAgICAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAgICAgIm1lbWJlcnMiOiB7DQogICAgICAgICAgICAgICAgICAiZmFicmljSXRlbU1lbWJlcnMiOiBbDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAiaXRlbUFjY2VzcyI6IFsNCiAgICAgICAgICAgICAgICAgICAgICAgICJSZWFkQWxsIg0KICAgICAgICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAgICAgICAgICAgInNvdXJjZVBhdGgiOiAiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwLzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCINCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXQ=="),
					PayloadType: to.Ptr(lakehouse.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("alm.settings.json"),
					Payload:     to.Ptr("ew0KICAgICAgICAgICJ2ZXJzaW9uIjogIjEuMC4xIiwNCiAgICAgICAgICAib2JqZWN0VHlwZXMiOiBbDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICJuYW1lIjogIlNob3J0Y3V0cyIsDQogICAgICAgICAgICAgICJzdGF0ZSI6ICJFbmFibGVkIiwNCiAgICAgICAgICAgICAgInN1Yk9iamVjdFR5cGVzIjogWw0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICJuYW1lIjogIlNob3J0Y3V0cy5PbmVMYWtlIiwNCiAgICAgICAgICAgICAgICAgICJzdGF0ZSI6ICJFbmFibGVkIg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiU2hvcnRjdXRzLkFkbHNHZW4yIiwNCiAgICAgICAgICAgICAgICAgICJzdGF0ZSI6ICJFbmFibGVkIg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiU2hvcnRjdXRzLkRhdGF2ZXJzZSIsDQogICAgICAgICAgICAgICAgICAic3RhdGUiOiAiRW5hYmxlZCINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICJuYW1lIjogIlNob3J0Y3V0cy5BbWF6b25TMyIsDQogICAgICAgICAgICAgICAgICAic3RhdGUiOiAiRW5hYmxlZCINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICJuYW1lIjogIlNob3J0Y3V0cy5TM0NvbXBhdGlibGUiLA0KICAgICAgICAgICAgICAgICAgInN0YXRlIjogIkVuYWJsZWQiDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAibmFtZSI6ICJTaG9ydGN1dHMuR29vZ2xlQ2xvdWRTdG9yYWdlIiwNCiAgICAgICAgICAgICAgICAgICJzdGF0ZSI6ICJFbmFibGVkIg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgIm5hbWUiOiAiRGF0YUFjY2Vzc1JvbGVzIiwNCiAgICAgICAgICAgICAgInN0YXRlIjogIkVuYWJsZWQiDQogICAgICAgICAgICB9DQogICAgICAgICAgXQ0KICAgICAgICB9"),
					PayloadType: to.Ptr(lakehouse.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr(".platform"),
					Payload:     to.Ptr("ewogICIkc2NoZW1hIjogImh0dHBzOi8vZGV2ZWxvcGVyLm1pY3Jvc29mdC5jb20vanNvbi1zY2hlbWFzL2ZhYnJpYy9naXRJbnRlZ3JhdGlvbi9wbGF0Zm9ybVByb3BlcnRpZXMvMi4wLjAvc2NoZW1hLmpzb24iLAogICJtZXRhZGF0YSI6IHsKICAgICJ0eXBlIjogIkxha2Vob3VzZSIsCiAgICAiZGlzcGxheU5hbWUiOiAiTGFrZWhvdXNlX2NyZWF0ZWRfd2l0aF9kZWZpbml0aW9uIiwKICAgICJkZXNjcmlwdGlvbiI6ICJFeGFtcGxlIGxha2Vob3VzZSB3aXRoIGRlZmluaXRpb24iCiAgfSwKICAiY29uZmlnIjogewogICAgInZlcnNpb24iOiAiMi4wIiwKICAgICJsb2dpY2FsSWQiOiAiN2Q2NDE0ZDEtMmM1Ni04OWI2LTQ4NzQtOWM4NDUwMzgxZDJiIgogIH0KfQ=="),
					PayloadType: to.Ptr(lakehouse.PayloadTypeInlineBase64),
				}},
		},
		DisplayName: to.Ptr("Lakehouse_created_with_definition"),
	}

	testsuite.serverFactory.ItemsServer.BeginCreateLakehouse = func(ctx context.Context, workspaceID string, createLakehouseRequest lakehouse.CreateLakehouseRequest, options *lakehouse.ItemsClientBeginCreateLakehouseOptions) (resp azfake.PollerResponder[lakehouse.ItemsClientCreateLakehouseResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().True(reflect.DeepEqual(exampleCreateLakehouseRequest, createLakehouseRequest))
		resp = azfake.PollerResponder[lakehouse.ItemsClientCreateLakehouseResponse]{}
		resp.SetTerminalResponse(http.StatusCreated, lakehouse.ItemsClientCreateLakehouseResponse{}, nil)
		return
	}

	poller, err = client.BeginCreateLakehouse(ctx, exampleWorkspaceID, exampleCreateLakehouseRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	_, err = poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")

	// From example
	ctx = runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Create a lakehouse with schema example"},
	})
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleCreateLakehouseRequest = lakehouse.CreateLakehouseRequest{
		Description: to.Ptr("A schema enabled lakehouse."),
		CreationPayload: &lakehouse.CreationPayload{
			EnableSchemas: to.Ptr(true),
		},
		DisplayName: to.Ptr("Lakehouse_created_with_schema"),
	}

	testsuite.serverFactory.ItemsServer.BeginCreateLakehouse = func(ctx context.Context, workspaceID string, createLakehouseRequest lakehouse.CreateLakehouseRequest, options *lakehouse.ItemsClientBeginCreateLakehouseOptions) (resp azfake.PollerResponder[lakehouse.ItemsClientCreateLakehouseResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().True(reflect.DeepEqual(exampleCreateLakehouseRequest, createLakehouseRequest))
		resp = azfake.PollerResponder[lakehouse.ItemsClientCreateLakehouseResponse]{}
		resp.SetTerminalResponse(http.StatusCreated, lakehouse.ItemsClientCreateLakehouseResponse{}, nil)
		return
	}

	poller, err = client.BeginCreateLakehouse(ctx, exampleWorkspaceID, exampleCreateLakehouseRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	_, err = poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")
}

func (testsuite *FakeTestSuite) TestItems_GetLakehouse() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get a lakehouse example"},
	})
	var exampleWorkspaceID string
	var exampleLakehouseID string
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleLakehouseID = "5b218778-e7a5-4d73-8187-f10824047715"

	exampleRes := lakehouse.Lakehouse{
		Type:        to.Ptr(lakehouse.ItemTypeLakehouse),
		Description: to.Ptr("A lakehouse description."),
		DisplayName: to.Ptr("Lakehouse_1"),
		ID:          to.Ptr("5b218778-e7a5-4d73-8187-f10824047715"),
		WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
		Properties: &lakehouse.Properties{
			OneLakeFilesPath:  to.Ptr("https://onelake.dfs.fabric.microsoft.com/2382cdf5-d577-44d0-a1fc-42184f29a7eb/e5fb215b-1934-413e-b33a-debaf844afde/Files"),
			OneLakeTablesPath: to.Ptr("https://onelake.dfs.fabric.microsoft.com/2382cdf5-d577-44d0-a1fc-42184f29a7eb/e5fb215b-1934-413e-b33a-debaf844afde/Tables"),
			SQLEndpointProperties: &lakehouse.SQLEndpointProperties{
				ConnectionString:   to.Ptr("qvrmbuxie7we7glrekxgy6npqu-6xgyei3x2xiejip4iime6knh5m.datawarehouse.fabric.microsoft.com"),
				ID:                 to.Ptr("37dc8a41-dea9-465d-b528-3e95043b2356"),
				ProvisioningStatus: to.Ptr(lakehouse.SQLEndpointProvisioningStatusSuccess),
			},
		},
	}

	testsuite.serverFactory.ItemsServer.GetLakehouse = func(ctx context.Context, workspaceID string, lakehouseID string, options *lakehouse.ItemsClientGetLakehouseOptions) (resp azfake.Responder[lakehouse.ItemsClientGetLakehouseResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		resp = azfake.Responder[lakehouse.ItemsClientGetLakehouseResponse]{}
		resp.SetResponse(http.StatusOK, lakehouse.ItemsClientGetLakehouseResponse{Lakehouse: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	res, err := client.GetLakehouse(ctx, exampleWorkspaceID, exampleLakehouseID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.Lakehouse))

	// From example
	ctx = runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get a lakehouse with schema example"},
	})
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleLakehouseID = "5b218778-e7a5-4d73-8187-f10824047715"

	exampleRes = lakehouse.Lakehouse{
		Type:        to.Ptr(lakehouse.ItemTypeLakehouse),
		Description: to.Ptr("A schema enabled lakehouse."),
		DisplayName: to.Ptr("Lakehouse_created_with_schema"),
		ID:          to.Ptr("5b218778-e7a5-4d73-8187-f10824047715"),
		WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
		Properties: &lakehouse.Properties{
			DefaultSchema:     to.Ptr("dbo"),
			OneLakeFilesPath:  to.Ptr("https://onelake.dfs.fabric.microsoft.com/2382cdf5-d577-44d0-a1fc-42184f29a7eb/e5fb215b-1934-413e-b33a-debaf844afde/Files"),
			OneLakeTablesPath: to.Ptr("https://onelake.dfs.fabric.microsoft.com/2382cdf5-d577-44d0-a1fc-42184f29a7eb/e5fb215b-1934-413e-b33a-debaf844afde/Tables"),
			SQLEndpointProperties: &lakehouse.SQLEndpointProperties{
				ConnectionString:   to.Ptr("qvrmbuxie7we7glrekxgy6npqu-6xgyei3x2xiejip4iime6knh5m.datawarehouse.fabric.microsoft.com"),
				ID:                 to.Ptr("37dc8a41-dea9-465d-b528-3e95043b2356"),
				ProvisioningStatus: to.Ptr(lakehouse.SQLEndpointProvisioningStatusSuccess),
			},
		},
	}

	testsuite.serverFactory.ItemsServer.GetLakehouse = func(ctx context.Context, workspaceID string, lakehouseID string, options *lakehouse.ItemsClientGetLakehouseOptions) (resp azfake.Responder[lakehouse.ItemsClientGetLakehouseResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		resp = azfake.Responder[lakehouse.ItemsClientGetLakehouseResponse]{}
		resp.SetResponse(http.StatusOK, lakehouse.ItemsClientGetLakehouseResponse{Lakehouse: exampleRes}, nil)
		return
	}

	res, err = client.GetLakehouse(ctx, exampleWorkspaceID, exampleLakehouseID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.Lakehouse))
}

func (testsuite *FakeTestSuite) TestItems_UpdateLakehouse() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Update a lakehouse example"},
	})
	var exampleWorkspaceID string
	var exampleLakehouseID string
	var exampleUpdateLakehouseRequest lakehouse.UpdateLakehouseRequest
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleLakehouseID = "5b218778-e7a5-4d73-8187-f10824047715"
	exampleUpdateLakehouseRequest = lakehouse.UpdateLakehouseRequest{
		Description: to.Ptr("A new description for lakehouse."),
		DisplayName: to.Ptr("Lakehouse_New_Name"),
	}

	exampleRes := lakehouse.Lakehouse{
		Type:        to.Ptr(lakehouse.ItemTypeLakehouse),
		Description: to.Ptr("A new description for lakehouse."),
		DisplayName: to.Ptr("Lakehouse_New_Name"),
		ID:          to.Ptr("5b218778-e7a5-4d73-8187-f10824047715"),
		WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
	}

	testsuite.serverFactory.ItemsServer.UpdateLakehouse = func(ctx context.Context, workspaceID string, lakehouseID string, updateLakehouseRequest lakehouse.UpdateLakehouseRequest, options *lakehouse.ItemsClientUpdateLakehouseOptions) (resp azfake.Responder[lakehouse.ItemsClientUpdateLakehouseResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		testsuite.Require().True(reflect.DeepEqual(exampleUpdateLakehouseRequest, updateLakehouseRequest))
		resp = azfake.Responder[lakehouse.ItemsClientUpdateLakehouseResponse]{}
		resp.SetResponse(http.StatusOK, lakehouse.ItemsClientUpdateLakehouseResponse{Lakehouse: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	res, err := client.UpdateLakehouse(ctx, exampleWorkspaceID, exampleLakehouseID, exampleUpdateLakehouseRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.Lakehouse))
}

func (testsuite *FakeTestSuite) TestItems_DeleteLakehouse() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Delete a lakehouse example"},
	})
	var exampleWorkspaceID string
	var exampleLakehouseID string
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleLakehouseID = "5b218778-e7a5-4d73-8187-f10824047715"

	testsuite.serverFactory.ItemsServer.DeleteLakehouse = func(ctx context.Context, workspaceID string, lakehouseID string, options *lakehouse.ItemsClientDeleteLakehouseOptions) (resp azfake.Responder[lakehouse.ItemsClientDeleteLakehouseResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		resp = azfake.Responder[lakehouse.ItemsClientDeleteLakehouseResponse]{}
		resp.SetResponse(http.StatusOK, lakehouse.ItemsClientDeleteLakehouseResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	_, err = client.DeleteLakehouse(ctx, exampleWorkspaceID, exampleLakehouseID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestItems_GetLakehouseDefinition() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get a lakehouse public definition example"},
	})
	var exampleWorkspaceID string
	var exampleLakehouseID string
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleLakehouseID = "5b218778-e7a5-4d73-8187-f10824047715"

	exampleRes := lakehouse.DefinitionResponse{
		Definition: &lakehouse.Definition{
			Parts: []lakehouse.DefinitionPart{
				{
					Path:        to.Ptr("lakehouse.metadata.json"),
					Payload:     to.Ptr("eyJkZWZhdWx0U2NoZW1hIjoiZGJvIn0="),
					PayloadType: to.Ptr(lakehouse.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("shortcuts.metadata.json"),
					Payload:     to.Ptr("WwogIHsKICAgICJuYW1lIjogIk55Y1RheGkiLAogICAgInBhdGgiOiAiL1RhYmxlcyIsCiAgICAidGFyZ2V0IjogewogICAgICAidHlwZSI6ICJPbmVMYWtlIiwKICAgICAgIm9uZUxha2UiOiB7CiAgICAgICAgInBhdGgiOiAiRmlsZXMvTnljVGF4aSIsCiAgICAgICAgIml0ZW1JZCI6ICIxNzBjYzY3Ni1hYzFhLTkwNmUtNDE5Mi0zZGJlZGM1MmYwMWUiLAogICAgICAgICJ3b3Jrc3BhY2VJZCI6ICJjZmFmYmViMS04MDM3LTRkMGMtODk2ZS1hNDZmYjI3ZmYyMjkiLAogICAgICAgICJhcnRpZmFjdFR5cGUiOiAiTGFrZWhvdXNlIgogICAgICB9CiAgICB9CiAgfQpd"),
					PayloadType: to.Ptr(lakehouse.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("data-access-roles.json"),
					Payload:     to.Ptr("Ww0KICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgIm5hbWUiOiAiZGltZW5zaW9ucnVsZXJlbmFtZSIsDQogICAgICAgICAgICAgICAgImtpbmQiOiAiUG9saWN5IiwNCiAgICAgICAgICAgICAgICAiZGVjaXNpb25SdWxlcyI6IFsNCiAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgImVmZmVjdCI6ICJQZXJtaXQiLA0KICAgICAgICAgICAgICAgICAgICAicGVybWlzc2lvbiI6IFsNCiAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAiYXR0cmlidXRlTmFtZSI6ICJQYXRoIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJhdHRyaWJ1dGVWYWx1ZUluY2x1ZGVkSW4iOiBbDQogICAgICAgICAgICAgICAgICAgICAgICAgICIvVGFibGVzL2Riby9kaW1lbnNpb25fY2l0eSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICIvVGFibGVzL2Riby9kaW1lbnNpb25fY3VzdG9tZXIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAiL1RhYmxlcy9kYm8vZGltZW5zaW9uX2RhdGUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAiL1RhYmxlcy9kYm8vZGltZW5zaW9uX2VtcGxveWVlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIi9UYWJsZXMvZGJvL2RpbWVuc2lvbl9zdG9ja19pdGVtIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIi9UYWJsZXMvYnJvbnplIg0KICAgICAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgImF0dHJpYnV0ZU5hbWUiOiAiQWN0aW9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJhdHRyaWJ1dGVWYWx1ZUluY2x1ZGVkSW4iOiBbDQogICAgICAgICAgICAgICAgICAgICAgICAgICJSZWFkIg0KICAgICAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgXSwNCiAgICAgICAgICAgICAgICAgICAgImNvbnN0cmFpbnRzIjoge30NCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBdLA0KICAgICAgICAgICAgICAgICJtZW1iZXJzIjogew0KICAgICAgICAgICAgICAgICAgImZhYnJpY0l0ZW1NZW1iZXJzIjogW10sDQogICAgICAgICAgICAgICAgICAgICJtaWNyb3NvZnRFbnRyYU1lbWJlcnMiOiBbDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAidGVuYW50SWQiOiAiMWU4NTAwMGUtZWUzNS00MTEyLWJkNDYtMmYwMGIzZDk0MTU0IiwNCiAgICAgICAgICAgICAgICAgICAgICAib2JqZWN0SWQiOiAiNWYzZWZkMzctYTZkMi00MzJmLTk5ZmEtNmFkYzI4NDhhNDBhIg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICBdDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgIm5hbWUiOiAiRGVmYXVsdFJlYWRlciIsDQogICAgICAgICAgICAgICAgImtpbmQiOiAiUG9saWN5IiwNCiAgICAgICAgICAgICAgICAiZGVjaXNpb25SdWxlcyI6IFsNCiAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgImVmZmVjdCI6ICJQZXJtaXQiLA0KICAgICAgICAgICAgICAgICAgICAicGVybWlzc2lvbiI6IFsNCiAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAiYXR0cmlidXRlTmFtZSI6ICJBY3Rpb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgImF0dHJpYnV0ZVZhbHVlSW5jbHVkZWRJbiI6IFsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIlJlYWQiDQogICAgICAgICAgICAgICAgICAgICAgICBdDQogICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAiYXR0cmlidXRlTmFtZSI6ICJQYXRoIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJhdHRyaWJ1dGVWYWx1ZUluY2x1ZGVkSW4iOiBbDQogICAgICAgICAgICAgICAgICAgICAgICAgICIqIg0KICAgICAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAgICAgIm1lbWJlcnMiOiB7DQogICAgICAgICAgICAgICAgICAiZmFicmljSXRlbU1lbWJlcnMiOiBbDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAiaXRlbUFjY2VzcyI6IFsNCiAgICAgICAgICAgICAgICAgICAgICAgICJSZWFkQWxsIg0KICAgICAgICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAgICAgICAgICAgInNvdXJjZVBhdGgiOiAiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwLzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCINCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXQ=="),
					PayloadType: to.Ptr(lakehouse.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("alm.settings.json"),
					Payload:     to.Ptr("ew0KICAgICAgICAgICJ2ZXJzaW9uIjogIjEuMC4xIiwNCiAgICAgICAgICAib2JqZWN0VHlwZXMiOiBbDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICJuYW1lIjogIlNob3J0Y3V0cyIsDQogICAgICAgICAgICAgICJzdGF0ZSI6ICJFbmFibGVkIiwNCiAgICAgICAgICAgICAgInN1Yk9iamVjdFR5cGVzIjogWw0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICJuYW1lIjogIlNob3J0Y3V0cy5PbmVMYWtlIiwNCiAgICAgICAgICAgICAgICAgICJzdGF0ZSI6ICJFbmFibGVkIg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiU2hvcnRjdXRzLkFkbHNHZW4yIiwNCiAgICAgICAgICAgICAgICAgICJzdGF0ZSI6ICJFbmFibGVkIg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiU2hvcnRjdXRzLkRhdGF2ZXJzZSIsDQogICAgICAgICAgICAgICAgICAic3RhdGUiOiAiRW5hYmxlZCINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICJuYW1lIjogIlNob3J0Y3V0cy5BbWF6b25TMyIsDQogICAgICAgICAgICAgICAgICAic3RhdGUiOiAiRW5hYmxlZCINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICJuYW1lIjogIlNob3J0Y3V0cy5TM0NvbXBhdGlibGUiLA0KICAgICAgICAgICAgICAgICAgInN0YXRlIjogIkVuYWJsZWQiDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAibmFtZSI6ICJTaG9ydGN1dHMuR29vZ2xlQ2xvdWRTdG9yYWdlIiwNCiAgICAgICAgICAgICAgICAgICJzdGF0ZSI6ICJFbmFibGVkIg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgIm5hbWUiOiAiRGF0YUFjY2Vzc1JvbGVzIiwNCiAgICAgICAgICAgICAgInN0YXRlIjogIkVuYWJsZWQiDQogICAgICAgICAgICB9DQogICAgICAgICAgXQ0KICAgICAgICB9"),
					PayloadType: to.Ptr(lakehouse.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr(".platform"),
					Payload:     to.Ptr("ewogICIkc2NoZW1hIjogImh0dHBzOi8vZGV2ZWxvcGVyLm1pY3Jvc29mdC5jb20vanNvbi1zY2hlbWFzL2ZhYnJpYy9naXRJbnRlZ3JhdGlvbi9wbGF0Zm9ybVByb3BlcnRpZXMvMi4wLjAvc2NoZW1hLmpzb24iLAogICJtZXRhZGF0YSI6IHsKICAgICJ0eXBlIjogIkxha2Vob3VzZSIsCiAgICAiZGlzcGxheU5hbWUiOiAiTGFrZWhvdXNlX2NyZWF0ZWRfd2l0aF9kZWZpbml0aW9uIiwKICAgICJkZXNjcmlwdGlvbiI6ICJFeGFtcGxlIGxha2Vob3VzZSB3aXRoIGRlZmluaXRpb24iCiAgfSwKICAiY29uZmlnIjogewogICAgInZlcnNpb24iOiAiMi4wIiwKICAgICJsb2dpY2FsSWQiOiAiN2Q2NDE0ZDEtMmM1Ni04OWI2LTQ4NzQtOWM4NDUwMzgxZDJiIgogIH0KfQ=="),
					PayloadType: to.Ptr(lakehouse.PayloadTypeInlineBase64),
				}},
		},
	}

	testsuite.serverFactory.ItemsServer.BeginGetLakehouseDefinition = func(ctx context.Context, workspaceID string, lakehouseID string, options *lakehouse.ItemsClientBeginGetLakehouseDefinitionOptions) (resp azfake.PollerResponder[lakehouse.ItemsClientGetLakehouseDefinitionResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		resp = azfake.PollerResponder[lakehouse.ItemsClientGetLakehouseDefinitionResponse]{}
		resp.SetTerminalResponse(http.StatusOK, lakehouse.ItemsClientGetLakehouseDefinitionResponse{DefinitionResponse: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	poller, err := client.BeginGetLakehouseDefinition(ctx, exampleWorkspaceID, exampleLakehouseID, &lakehouse.ItemsClientBeginGetLakehouseDefinitionOptions{Format: nil})
	testsuite.Require().NoError(err, "Failed to get result for example ")
	res, err := poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.DefinitionResponse))
}

func (testsuite *FakeTestSuite) TestItems_UpdateLakehouseDefinition() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Update a lakehouse public definition example"},
	})
	var exampleWorkspaceID string
	var exampleLakehouseID string
	var exampleUpdateLakehouseDefinitionRequest lakehouse.UpdateLakehouseDefinitionRequest
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleLakehouseID = "5b218778-e7a5-4d73-8187-f10824047715"
	exampleUpdateLakehouseDefinitionRequest = lakehouse.UpdateLakehouseDefinitionRequest{
		Definition: &lakehouse.Definition{
			Format: to.Ptr("LakehouseDefinitionV1"),
			Parts: []lakehouse.DefinitionPart{
				{
					Path:        to.Ptr("lakehouse.metadata.json"),
					Payload:     to.Ptr("eyJkZWZhdWx0U2NoZW1hIjoiZGJvIn0="),
					PayloadType: to.Ptr(lakehouse.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("shortcuts.metadata.json"),
					Payload:     to.Ptr("WwogIHsKICAgICJuYW1lIjogIk55Y1RheGkiLAogICAgInBhdGgiOiAiL1RhYmxlcyIsCiAgICAidGFyZ2V0IjogewogICAgICAidHlwZSI6ICJPbmVMYWtlIiwKICAgICAgIm9uZUxha2UiOiB7CiAgICAgICAgInBhdGgiOiAiRmlsZXMvTnljVGF4aSIsCiAgICAgICAgIml0ZW1JZCI6ICIxNzBjYzY3Ni1hYzFhLTkwNmUtNDE5Mi0zZGJlZGM1MmYwMWUiLAogICAgICAgICJ3b3Jrc3BhY2VJZCI6ICJjZmFmYmViMS04MDM3LTRkMGMtODk2ZS1hNDZmYjI3ZmYyMjkiLAogICAgICAgICJhcnRpZmFjdFR5cGUiOiAiTGFrZWhvdXNlIgogICAgICB9CiAgICB9CiAgfQpd"),
					PayloadType: to.Ptr(lakehouse.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("data-access-roles.json"),
					Payload:     to.Ptr("Ww0KICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgIm5hbWUiOiAiZGltZW5zaW9ucnVsZXJlbmFtZSIsDQogICAgICAgICAgICAgICAgImtpbmQiOiAiUG9saWN5IiwNCiAgICAgICAgICAgICAgICAiZGVjaXNpb25SdWxlcyI6IFsNCiAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgImVmZmVjdCI6ICJQZXJtaXQiLA0KICAgICAgICAgICAgICAgICAgICAicGVybWlzc2lvbiI6IFsNCiAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAiYXR0cmlidXRlTmFtZSI6ICJQYXRoIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJhdHRyaWJ1dGVWYWx1ZUluY2x1ZGVkSW4iOiBbDQogICAgICAgICAgICAgICAgICAgICAgICAgICIvVGFibGVzL2Riby9kaW1lbnNpb25fY2l0eSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICIvVGFibGVzL2Riby9kaW1lbnNpb25fY3VzdG9tZXIiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAiL1RhYmxlcy9kYm8vZGltZW5zaW9uX2RhdGUiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAiL1RhYmxlcy9kYm8vZGltZW5zaW9uX2VtcGxveWVlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIi9UYWJsZXMvZGJvL2RpbWVuc2lvbl9zdG9ja19pdGVtIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIi9UYWJsZXMvYnJvbnplIg0KICAgICAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgICAgICAgImF0dHJpYnV0ZU5hbWUiOiAiQWN0aW9uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJhdHRyaWJ1dGVWYWx1ZUluY2x1ZGVkSW4iOiBbDQogICAgICAgICAgICAgICAgICAgICAgICAgICJSZWFkIg0KICAgICAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgXSwNCiAgICAgICAgICAgICAgICAgICAgImNvbnN0cmFpbnRzIjoge30NCiAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBdLA0KICAgICAgICAgICAgICAgICJtZW1iZXJzIjogew0KICAgICAgICAgICAgICAgICAgImZhYnJpY0l0ZW1NZW1iZXJzIjogW10sDQogICAgICAgICAgICAgICAgICAgICJtaWNyb3NvZnRFbnRyYU1lbWJlcnMiOiBbDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAidGVuYW50SWQiOiAiMWU4NTAwMGUtZWUzNS00MTEyLWJkNDYtMmYwMGIzZDk0MTU0IiwNCiAgICAgICAgICAgICAgICAgICAgICAib2JqZWN0SWQiOiAiNWYzZWZkMzctYTZkMi00MzJmLTk5ZmEtNmFkYzI4NDhhNDBhIg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICBdDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgIm5hbWUiOiAiRGVmYXVsdFJlYWRlciIsDQogICAgICAgICAgICAgICAgImtpbmQiOiAiUG9saWN5IiwNCiAgICAgICAgICAgICAgICAiZGVjaXNpb25SdWxlcyI6IFsNCiAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgImVmZmVjdCI6ICJQZXJtaXQiLA0KICAgICAgICAgICAgICAgICAgICAicGVybWlzc2lvbiI6IFsNCiAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAiYXR0cmlidXRlTmFtZSI6ICJBY3Rpb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgImF0dHJpYnV0ZVZhbHVlSW5jbHVkZWRJbiI6IFsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgIlJlYWQiDQogICAgICAgICAgICAgICAgICAgICAgICBdDQogICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAgICAgICAiYXR0cmlidXRlTmFtZSI6ICJQYXRoIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICJhdHRyaWJ1dGVWYWx1ZUluY2x1ZGVkSW4iOiBbDQogICAgICAgICAgICAgICAgICAgICAgICAgICIqIg0KICAgICAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAgICAgIm1lbWJlcnMiOiB7DQogICAgICAgICAgICAgICAgICAiZmFicmljSXRlbU1lbWJlcnMiOiBbDQogICAgICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgICAiaXRlbUFjY2VzcyI6IFsNCiAgICAgICAgICAgICAgICAgICAgICAgICJSZWFkQWxsIg0KICAgICAgICAgICAgICAgICAgICAgIF0sDQogICAgICAgICAgICAgICAgICAgICAgInNvdXJjZVBhdGgiOiAiMDAwMDAwMDAtMDAwMC0wMDAwLTAwMDAtMDAwMDAwMDAwMDAwLzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCINCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgXQ=="),
					PayloadType: to.Ptr(lakehouse.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("alm.settings.json"),
					Payload:     to.Ptr("ew0KICAgICAgICAgICJ2ZXJzaW9uIjogIjEuMC4xIiwNCiAgICAgICAgICAib2JqZWN0VHlwZXMiOiBbDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgICJuYW1lIjogIlNob3J0Y3V0cyIsDQogICAgICAgICAgICAgICJzdGF0ZSI6ICJFbmFibGVkIiwNCiAgICAgICAgICAgICAgInN1Yk9iamVjdFR5cGVzIjogWw0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICJuYW1lIjogIlNob3J0Y3V0cy5PbmVMYWtlIiwNCiAgICAgICAgICAgICAgICAgICJzdGF0ZSI6ICJFbmFibGVkIg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiU2hvcnRjdXRzLkFkbHNHZW4yIiwNCiAgICAgICAgICAgICAgICAgICJzdGF0ZSI6ICJFbmFibGVkIg0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgIm5hbWUiOiAiU2hvcnRjdXRzLkRhdGF2ZXJzZSIsDQogICAgICAgICAgICAgICAgICAic3RhdGUiOiAiRW5hYmxlZCINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICJuYW1lIjogIlNob3J0Y3V0cy5BbWF6b25TMyIsDQogICAgICAgICAgICAgICAgICAic3RhdGUiOiAiRW5hYmxlZCINCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICJuYW1lIjogIlNob3J0Y3V0cy5TM0NvbXBhdGlibGUiLA0KICAgICAgICAgICAgICAgICAgInN0YXRlIjogIkVuYWJsZWQiDQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICAibmFtZSI6ICJTaG9ydGN1dHMuR29vZ2xlQ2xvdWRTdG9yYWdlIiwNCiAgICAgICAgICAgICAgICAgICJzdGF0ZSI6ICJFbmFibGVkIg0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgIm5hbWUiOiAiRGF0YUFjY2Vzc1JvbGVzIiwNCiAgICAgICAgICAgICAgInN0YXRlIjogIkVuYWJsZWQiDQogICAgICAgICAgICB9DQogICAgICAgICAgXQ0KICAgICAgICB9"),
					PayloadType: to.Ptr(lakehouse.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr(".platform"),
					Payload:     to.Ptr("ewogICIkc2NoZW1hIjogImh0dHBzOi8vZGV2ZWxvcGVyLm1pY3Jvc29mdC5jb20vanNvbi1zY2hlbWFzL2ZhYnJpYy9naXRJbnRlZ3JhdGlvbi9wbGF0Zm9ybVByb3BlcnRpZXMvMi4wLjAvc2NoZW1hLmpzb24iLAogICJtZXRhZGF0YSI6IHsKICAgICJ0eXBlIjogIkxha2Vob3VzZSIsCiAgICAiZGlzcGxheU5hbWUiOiAiTGFrZWhvdXNlX2NyZWF0ZWRfd2l0aF9kZWZpbml0aW9uIiwKICAgICJkZXNjcmlwdGlvbiI6ICJFeGFtcGxlIGxha2Vob3VzZSB3aXRoIGRlZmluaXRpb24iCiAgfSwKICAiY29uZmlnIjogewogICAgInZlcnNpb24iOiAiMi4wIiwKICAgICJsb2dpY2FsSWQiOiAiN2Q2NDE0ZDEtMmM1Ni04OWI2LTQ4NzQtOWM4NDUwMzgxZDJiIgogIH0KfQ=="),
					PayloadType: to.Ptr(lakehouse.PayloadTypeInlineBase64),
				}},
		},
	}

	exampleRes := lakehouse.Lakehouse{
		Type:        to.Ptr(lakehouse.ItemTypeLakehouse),
		Description: to.Ptr("A new description for lakehouse."),
		DisplayName: to.Ptr("Lakehouse_New_Name"),
		ID:          to.Ptr("5b218778-e7a5-4d73-8187-f10824047715"),
		WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
	}

	testsuite.serverFactory.ItemsServer.BeginUpdateLakehouseDefinition = func(ctx context.Context, workspaceID string, lakehouseID string, updateLakehouseDefinitionRequest lakehouse.UpdateLakehouseDefinitionRequest, options *lakehouse.ItemsClientBeginUpdateLakehouseDefinitionOptions) (resp azfake.PollerResponder[lakehouse.ItemsClientUpdateLakehouseDefinitionResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		testsuite.Require().True(reflect.DeepEqual(exampleUpdateLakehouseDefinitionRequest, updateLakehouseDefinitionRequest))
		resp = azfake.PollerResponder[lakehouse.ItemsClientUpdateLakehouseDefinitionResponse]{}
		resp.SetTerminalResponse(http.StatusOK, lakehouse.ItemsClientUpdateLakehouseDefinitionResponse{Lakehouse: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	poller, err := client.BeginUpdateLakehouseDefinition(ctx, exampleWorkspaceID, exampleLakehouseID, exampleUpdateLakehouseDefinitionRequest, &lakehouse.ItemsClientBeginUpdateLakehouseDefinitionOptions{UpdateMetadata: to.Ptr(true)})
	testsuite.Require().NoError(err, "Failed to get result for example ")
	res, err := poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.Lakehouse))
}

func (testsuite *FakeTestSuite) TestTables_ListTables() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"List tables example"},
	})
	var exampleWorkspaceID string
	var exampleLakehouseID string
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleLakehouseID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"

	exampleRes := lakehouse.Tables{
		ContinuationToken: to.Ptr("+RID:~HTsuAOseYicH-GcAAAAAAA==#RT:1#TRC:1#ISV:2#IEO:65567#QCF:8#FPC:AgKfAZ8BnwEEAAe8eoA="),
		ContinuationURI:   to.Ptr("https://api.fabric.microsoft.com/v1/workspaces/f089354e-8366-4e18-aea3-4cb4a3a50b48/lakehouses/41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87/tables?continuationToken=%2BRID%3A~HTsuAOseYicH-GcAAAAAAA%3D%3D%23RT%3A1%23TRC%3A1%23ISV%3A2%23IEO%3A65567%23QCF%3A8%23FPC%3AAgKfAZ8BnwEEAAe8eoA%3D"),
		Data: []lakehouse.Table{
			{
				Name:     to.Ptr("Table1"),
				Type:     to.Ptr(lakehouse.TableTypeManaged),
				Format:   to.Ptr("Delta"),
				Location: to.Ptr("abfss://f089354e-8366-4e18-aea3-4cb4a3a50b48@onelake.dfs.fabric.microsoft.com/41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87/Tables/Table1"),
			}},
	}

	testsuite.serverFactory.TablesServer.NewListTablesPager = func(workspaceID string, lakehouseID string, options *lakehouse.TablesClientListTablesOptions) (resp azfake.PagerResponder[lakehouse.TablesClientListTablesResponse]) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		resp = azfake.PagerResponder[lakehouse.TablesClientListTablesResponse]{}
		resp.AddPage(http.StatusOK, lakehouse.TablesClientListTablesResponse{Tables: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewTablesClient()
	pager := client.NewListTablesPager(exampleWorkspaceID, exampleLakehouseID, &lakehouse.TablesClientListTablesOptions{MaxResults: to.Ptr[int32](10),
		ContinuationToken: to.Ptr(""),
	})
	for pager.More() {
		nextResult, err := pager.NextPage(ctx)
		testsuite.Require().NoError(err, "Failed to advance page for example ")
		testsuite.Require().True(reflect.DeepEqual(exampleRes, nextResult.Tables))
		if err == nil {
			break
		}
	}
}

func (testsuite *FakeTestSuite) TestBackgroundJobs_RunOnDemandTableMaintenance() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Run table maintenance with optimize Z-Order and vacuum enabled for schema enabled lakehouse."},
	})
	var exampleWorkspaceID string
	var exampleLakehouseID string
	var exampleRunOnDemandTableMaintenanceRequest lakehouse.RunOnDemandTableMaintenanceRequest
	exampleWorkspaceID = "4b218778-e7a5-4d73-8187-f10824047715"
	exampleLakehouseID = "431e8d7b-4a95-4c02-8ccd-6faef5ba1bd7"
	exampleRunOnDemandTableMaintenanceRequest = lakehouse.RunOnDemandTableMaintenanceRequest{
		ExecutionData: &lakehouse.TableMaintenanceExecutionData{
			OptimizeSettings: &lakehouse.OptimizeSettings{
				VOrder: to.Ptr(true),
				ZOrderBy: []string{
					"tipAmount"},
			},
			SchemaName: to.Ptr("dbo"),
			TableName:  to.Ptr("table1"),
			VacuumSettings: &lakehouse.VacuumSettings{
				RetentionPeriod: to.Ptr("7:01:00:00"),
			},
		},
	}

	testsuite.serverFactory.BackgroundJobsServer.RunOnDemandTableMaintenance = func(ctx context.Context, workspaceID string, lakehouseID string, runOnDemandTableMaintenanceRequest lakehouse.RunOnDemandTableMaintenanceRequest, options *lakehouse.BackgroundJobsClientRunOnDemandTableMaintenanceOptions) (resp azfake.Responder[lakehouse.BackgroundJobsClientRunOnDemandTableMaintenanceResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		testsuite.Require().True(reflect.DeepEqual(exampleRunOnDemandTableMaintenanceRequest, runOnDemandTableMaintenanceRequest))
		resp = azfake.Responder[lakehouse.BackgroundJobsClientRunOnDemandTableMaintenanceResponse]{}
		resp.SetResponse(http.StatusAccepted, lakehouse.BackgroundJobsClientRunOnDemandTableMaintenanceResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewBackgroundJobsClient()
	_, err = client.RunOnDemandTableMaintenance(ctx, exampleWorkspaceID, exampleLakehouseID, exampleRunOnDemandTableMaintenanceRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")

	// From example
	ctx = runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Run table maintenance with optimize Z-Order and vacuum enabled."},
	})
	exampleWorkspaceID = "4b218778-e7a5-4d73-8187-f10824047715"
	exampleLakehouseID = "431e8d7b-4a95-4c02-8ccd-6faef5ba1bd7"
	exampleRunOnDemandTableMaintenanceRequest = lakehouse.RunOnDemandTableMaintenanceRequest{
		ExecutionData: &lakehouse.TableMaintenanceExecutionData{
			OptimizeSettings: &lakehouse.OptimizeSettings{
				VOrder: to.Ptr(true),
				ZOrderBy: []string{
					"tipAmount"},
			},
			TableName: to.Ptr("table1"),
			VacuumSettings: &lakehouse.VacuumSettings{
				RetentionPeriod: to.Ptr("7:01:00:00"),
			},
		},
	}

	testsuite.serverFactory.BackgroundJobsServer.RunOnDemandTableMaintenance = func(ctx context.Context, workspaceID string, lakehouseID string, runOnDemandTableMaintenanceRequest lakehouse.RunOnDemandTableMaintenanceRequest, options *lakehouse.BackgroundJobsClientRunOnDemandTableMaintenanceOptions) (resp azfake.Responder[lakehouse.BackgroundJobsClientRunOnDemandTableMaintenanceResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		testsuite.Require().True(reflect.DeepEqual(exampleRunOnDemandTableMaintenanceRequest, runOnDemandTableMaintenanceRequest))
		resp = azfake.Responder[lakehouse.BackgroundJobsClientRunOnDemandTableMaintenanceResponse]{}
		resp.SetResponse(http.StatusAccepted, lakehouse.BackgroundJobsClientRunOnDemandTableMaintenanceResponse{}, nil)
		return
	}

	_, err = client.RunOnDemandTableMaintenance(ctx, exampleWorkspaceID, exampleLakehouseID, exampleRunOnDemandTableMaintenanceRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")

	// From example
	ctx = runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Run table maintenance with optimize enabled and vacuum disabled."},
	})
	exampleWorkspaceID = "4b218778-e7a5-4d73-8187-f10824047715"
	exampleLakehouseID = "431e8d7b-4a95-4c02-8ccd-6faef5ba1bd7"
	exampleRunOnDemandTableMaintenanceRequest = lakehouse.RunOnDemandTableMaintenanceRequest{
		ExecutionData: &lakehouse.TableMaintenanceExecutionData{
			OptimizeSettings: &lakehouse.OptimizeSettings{},
			TableName:        to.Ptr("table1"),
		},
	}

	testsuite.serverFactory.BackgroundJobsServer.RunOnDemandTableMaintenance = func(ctx context.Context, workspaceID string, lakehouseID string, runOnDemandTableMaintenanceRequest lakehouse.RunOnDemandTableMaintenanceRequest, options *lakehouse.BackgroundJobsClientRunOnDemandTableMaintenanceOptions) (resp azfake.Responder[lakehouse.BackgroundJobsClientRunOnDemandTableMaintenanceResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		testsuite.Require().True(reflect.DeepEqual(exampleRunOnDemandTableMaintenanceRequest, runOnDemandTableMaintenanceRequest))
		resp = azfake.Responder[lakehouse.BackgroundJobsClientRunOnDemandTableMaintenanceResponse]{}
		resp.SetResponse(http.StatusAccepted, lakehouse.BackgroundJobsClientRunOnDemandTableMaintenanceResponse{}, nil)
		return
	}

	_, err = client.RunOnDemandTableMaintenance(ctx, exampleWorkspaceID, exampleLakehouseID, exampleRunOnDemandTableMaintenanceRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestBackgroundJobs_CreateRefreshMaterializedLakeViewsSchedule() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Create lakehouse Refresh MaterializedLakeViews schedule example"},
	})
	var exampleWorkspaceID string
	var exampleLakehouseID string
	var exampleCreateScheduleRequest lakehouse.CreateLakehouseRefreshMaterializedLakeViewsScheduleRequest
	exampleWorkspaceID = "a0a0a0a0-bbbb-cccc-dddd-e1e1e1e1e1e1"
	exampleLakehouseID = "dddddddd-9999-0000-1111-eeeeeeeeeeee"
	exampleCreateScheduleRequest = lakehouse.CreateLakehouseRefreshMaterializedLakeViewsScheduleRequest{
		Configuration: &lakehouse.CronScheduleConfig{
			Type:            to.Ptr(lakehouse.ScheduleTypeCron),
			EndDateTime:     to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-04-30T23:59:00.000Z"); return t }()),
			LocalTimeZoneID: to.Ptr("Central Standard Time"),
			StartDateTime:   to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-04-28T00:00:00.000Z"); return t }()),
			Interval:        to.Ptr[int32](10),
		},
		Enabled: to.Ptr(true),
	}

	testsuite.serverFactory.BackgroundJobsServer.CreateRefreshMaterializedLakeViewsSchedule = func(ctx context.Context, workspaceID string, lakehouseID string, createScheduleRequest lakehouse.CreateLakehouseRefreshMaterializedLakeViewsScheduleRequest, options *lakehouse.BackgroundJobsClientCreateRefreshMaterializedLakeViewsScheduleOptions) (resp azfake.Responder[lakehouse.BackgroundJobsClientCreateRefreshMaterializedLakeViewsScheduleResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		testsuite.Require().True(reflect.DeepEqual(exampleCreateScheduleRequest, createScheduleRequest))
		resp = azfake.Responder[lakehouse.BackgroundJobsClientCreateRefreshMaterializedLakeViewsScheduleResponse]{}
		resp.SetResponse(http.StatusCreated, lakehouse.BackgroundJobsClientCreateRefreshMaterializedLakeViewsScheduleResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewBackgroundJobsClient()
	_, err = client.CreateRefreshMaterializedLakeViewsSchedule(ctx, exampleWorkspaceID, exampleLakehouseID, exampleCreateScheduleRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestBackgroundJobs_RunOnDemandRefreshMaterializedLakeViews() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Run RefreshMaterializedLakeViews with no request body."},
	})
	var exampleWorkspaceID string
	var exampleLakehouseID string
	exampleWorkspaceID = "4b218778-e7a5-4d73-8187-f10824047715"
	exampleLakehouseID = "431e8d7b-4a95-4c02-8ccd-6faef5ba1bd7"

	testsuite.serverFactory.BackgroundJobsServer.RunOnDemandRefreshMaterializedLakeViews = func(ctx context.Context, workspaceID string, lakehouseID string, options *lakehouse.BackgroundJobsClientRunOnDemandRefreshMaterializedLakeViewsOptions) (resp azfake.Responder[lakehouse.BackgroundJobsClientRunOnDemandRefreshMaterializedLakeViewsResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		resp = azfake.Responder[lakehouse.BackgroundJobsClientRunOnDemandRefreshMaterializedLakeViewsResponse]{}
		resp.SetResponse(http.StatusAccepted, lakehouse.BackgroundJobsClientRunOnDemandRefreshMaterializedLakeViewsResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewBackgroundJobsClient()
	_, err = client.RunOnDemandRefreshMaterializedLakeViews(ctx, exampleWorkspaceID, exampleLakehouseID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestBackgroundJobs_UpdateRefreshMaterializedLakeViewsSchedule() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Update lakehouse Refresh MaterializedLakeViews schedule example"},
	})
	var exampleWorkspaceID string
	var exampleLakehouseID string
	var exampleScheduleID string
	var exampleUpdateScheduleRequest lakehouse.UpdateLakehouseRefreshMaterializedLakeViewsScheduleRequest
	exampleWorkspaceID = "a0a0a0a0-bbbb-cccc-dddd-e1e1e1e1e1e1"
	exampleLakehouseID = "dddddddd-9999-0000-1111-eeeeeeeeeeee"
	exampleScheduleID = "bbbbbbbb-1111-2222-3333-cccccccccccc"
	exampleUpdateScheduleRequest = lakehouse.UpdateLakehouseRefreshMaterializedLakeViewsScheduleRequest{
		Configuration: &lakehouse.CronScheduleConfig{
			Type:            to.Ptr(lakehouse.ScheduleTypeCron),
			EndDateTime:     to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-05-31T23:59:00.000Z"); return t }()),
			LocalTimeZoneID: to.Ptr("Pacific Standard Time"),
			StartDateTime:   to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-05-01T00:00:00.000Z"); return t }()),
			Interval:        to.Ptr[int32](15),
		},
		Enabled: to.Ptr(false),
	}

	exampleRes := lakehouse.RefreshMaterializedLakeViewsSchedule{
		Configuration: &lakehouse.CronScheduleConfig{
			Type:            to.Ptr(lakehouse.ScheduleTypeCron),
			EndDateTime:     to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-05-31T23:59:00.000Z"); return t }()),
			LocalTimeZoneID: to.Ptr("Pacific Standard Time"),
			StartDateTime:   to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-05-01T00:00:00.000Z"); return t }()),
			Interval:        to.Ptr[int32](15),
		},
		CreatedDateTime: to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2024-05-28T05:35:20.536Z"); return t }()),
		Enabled:         to.Ptr(false),
		ID:              to.Ptr("bbbbbbbb-1111-2222-3333-cccccccccccc"),
		Owner: &lakehouse.Principal{
			Type: to.Ptr(lakehouse.PrincipalTypeUser),
			ID:   to.Ptr("33dd33dd-ee44-ff55-aa66-77bb77bb77bb"),
		},
	}

	testsuite.serverFactory.BackgroundJobsServer.UpdateRefreshMaterializedLakeViewsSchedule = func(ctx context.Context, workspaceID string, lakehouseID string, scheduleID string, updateScheduleRequest lakehouse.UpdateLakehouseRefreshMaterializedLakeViewsScheduleRequest, options *lakehouse.BackgroundJobsClientUpdateRefreshMaterializedLakeViewsScheduleOptions) (resp azfake.Responder[lakehouse.BackgroundJobsClientUpdateRefreshMaterializedLakeViewsScheduleResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		testsuite.Require().Equal(exampleScheduleID, scheduleID)
		testsuite.Require().True(reflect.DeepEqual(exampleUpdateScheduleRequest, updateScheduleRequest))
		resp = azfake.Responder[lakehouse.BackgroundJobsClientUpdateRefreshMaterializedLakeViewsScheduleResponse]{}
		resp.SetResponse(http.StatusOK, lakehouse.BackgroundJobsClientUpdateRefreshMaterializedLakeViewsScheduleResponse{RefreshMaterializedLakeViewsSchedule: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewBackgroundJobsClient()
	res, err := client.UpdateRefreshMaterializedLakeViewsSchedule(ctx, exampleWorkspaceID, exampleLakehouseID, exampleScheduleID, exampleUpdateScheduleRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.RefreshMaterializedLakeViewsSchedule))
}

func (testsuite *FakeTestSuite) TestBackgroundJobs_DeleteRefreshMaterializedLakeViewsSchedule() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Delete lakehouse Refresh MaterializedLakeViews schedule example"},
	})
	var exampleWorkspaceID string
	var exampleLakehouseID string
	var exampleScheduleID string
	exampleWorkspaceID = "a0a0a0a0-bbbb-cccc-dddd-e1e1e1e1e1e1"
	exampleLakehouseID = "dddddddd-9999-0000-1111-eeeeeeeeeeee"
	exampleScheduleID = "bbbbbbbb-1111-2222-3333-cccccccccccc"

	testsuite.serverFactory.BackgroundJobsServer.DeleteRefreshMaterializedLakeViewsSchedule = func(ctx context.Context, workspaceID string, lakehouseID string, scheduleID string, options *lakehouse.BackgroundJobsClientDeleteRefreshMaterializedLakeViewsScheduleOptions) (resp azfake.Responder[lakehouse.BackgroundJobsClientDeleteRefreshMaterializedLakeViewsScheduleResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		testsuite.Require().Equal(exampleScheduleID, scheduleID)
		resp = azfake.Responder[lakehouse.BackgroundJobsClientDeleteRefreshMaterializedLakeViewsScheduleResponse]{}
		resp.SetResponse(http.StatusOK, lakehouse.BackgroundJobsClientDeleteRefreshMaterializedLakeViewsScheduleResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewBackgroundJobsClient()
	_, err = client.DeleteRefreshMaterializedLakeViewsSchedule(ctx, exampleWorkspaceID, exampleLakehouseID, exampleScheduleID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestLivySessions_ListLivySessions() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"List all livy sessions example"},
	})
	var exampleWorkspaceID string
	var exampleLakehouseID string
	exampleWorkspaceID = "f8113ba8-dd81-443e-811a-b385340f3f05"
	exampleLakehouseID = "8cee7699-2e81-4121-9a53-cc9025046193"

	exampleRes := lakehouse.LivySessions{
		Value: []lakehouse.LivySession{
			{
				AttemptNumber:      to.Ptr[int32](1),
				CancellationReason: to.Ptr("User cancelled the Spark batch"),
				CapacityID:         to.Ptr("3c0cd366-dc28-4b6d-a525-4d415a8666e7"),
				CreatorItem: &lakehouse.ItemReferenceByID{
					ReferenceType: to.Ptr(lakehouse.ItemReferenceTypeByID),
					ItemID:        to.Ptr("8cee7699-2e81-4121-9a53-cc9025046193"),
					WorkspaceID:   to.Ptr("f8113ba8-dd81-443e-811a-b385340f3f05"),
				},
				DriverCores:                   to.Ptr[int32](2),
				DriverMemory:                  to.Ptr[int32](4),
				DynamicAllocationMaxExecutors: to.Ptr[int32](20),
				EndDateTime:                   to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-01-31T15:37:30.000Z"); return t }()),
				ExecutorCores:                 float64(4),
				ExecutorMemory:                to.Ptr[int32](8),
				IsDynamicAllocationEnabled:    to.Ptr(true),
				Item: &lakehouse.ItemReferenceByID{
					ReferenceType: to.Ptr(lakehouse.ItemReferenceTypeByID),
					ItemID:        to.Ptr("8cee7699-2e81-4121-9a53-cc9025046193"),
					WorkspaceID:   to.Ptr("f8113ba8-dd81-443e-811a-b385340f3f05"),
				},
				ItemName:                   to.Ptr("lh_itemName"),
				ItemType:                   to.Ptr(lakehouse.LivySessionItemTypeLakehouse),
				JobInstanceID:              to.Ptr("c2baabbd-5327-430c-87a6-ff4f98285601"),
				JobType:                    to.Ptr(lakehouse.JobTypeSparkBatch),
				LivyID:                     to.Ptr("9611f500-bf44-42e0-a0de-78dacb374398"),
				LivyName:                   to.Ptr("random_test_name_app"),
				LivySessionItemResourceURI: to.Ptr(""),
				MaxNumberOfAttempts:        to.Ptr[int32](1),
				NumExecutors:               to.Ptr[int32](10),
				OperationName:              to.Ptr("Batch Livy Run"),
				Origin:                     to.Ptr(lakehouse.OriginSubmittedJob),
				QueuedDuration: &lakehouse.Duration{
					TimeUnit: to.Ptr(lakehouse.TimeUnitSeconds),
					Value:    to.Ptr[float32](1),
				},
				RunningDuration: &lakehouse.Duration{
					TimeUnit: to.Ptr(lakehouse.TimeUnitSeconds),
					Value:    to.Ptr[float32](180),
				},
				RuntimeVersion:     to.Ptr("1.3"),
				SparkApplicationID: to.Ptr("application_1730933685452_0001"),
				StartDateTime:      to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-01-31T15:34:11.000Z"); return t }()),
				State:              to.Ptr(lakehouse.StateCancelled),
				SubmittedDateTime:  to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-01-31T15:32:03.000Z"); return t }()),
				Submitter: &lakehouse.Principal{
					Type: to.Ptr(lakehouse.PrincipalTypeUser),
					ID:   to.Ptr("6f23a8a6-d954-4550-b91a-4df73ccd0311"),
				},
				TotalDuration: &lakehouse.Duration{
					TimeUnit: to.Ptr(lakehouse.TimeUnitSeconds),
					Value:    to.Ptr[float32](360),
				},
			}},
	}

	testsuite.serverFactory.LivySessionsServer.NewListLivySessionsPager = func(workspaceID string, lakehouseID string, options *lakehouse.LivySessionsClientListLivySessionsOptions) (resp azfake.PagerResponder[lakehouse.LivySessionsClientListLivySessionsResponse]) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		resp = azfake.PagerResponder[lakehouse.LivySessionsClientListLivySessionsResponse]{}
		resp.AddPage(http.StatusOK, lakehouse.LivySessionsClientListLivySessionsResponse{LivySessions: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewLivySessionsClient()
	pager := client.NewListLivySessionsPager(exampleWorkspaceID, exampleLakehouseID, &lakehouse.LivySessionsClientListLivySessionsOptions{ContinuationToken: nil})
	for pager.More() {
		nextResult, err := pager.NextPage(ctx)
		testsuite.Require().NoError(err, "Failed to advance page for example ")
		testsuite.Require().True(reflect.DeepEqual(exampleRes, nextResult.LivySessions))
		if err == nil {
			break
		}
	}
}

func (testsuite *FakeTestSuite) TestLivySessions_ListLivySessionsBeta() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"List all livy sessions (Beta) example"},
	})
	var exampleWorkspaceID string
	var exampleLakehouseID string
	var exampleBeta bool
	exampleWorkspaceID = "f8113ba8-dd81-443e-811a-b385340f3f05"
	exampleLakehouseID = "8cee7699-2e81-4121-9a53-cc9025046193"
	exampleBeta = true

	exampleRes := lakehouse.LivySessions{
		Value: []lakehouse.LivySession{
			{
				AttemptNumber:      to.Ptr[int32](1),
				CancellationReason: to.Ptr("User cancelled the Spark batch"),
				CapacityID:         to.Ptr("3c0cd366-dc28-4b6d-a525-4d415a8666e7"),
				CreatorItem: &lakehouse.ItemReferenceByID{
					ReferenceType: to.Ptr(lakehouse.ItemReferenceTypeByID),
					ItemID:        to.Ptr("8cee7699-2e81-4121-9a53-cc9025046193"),
					WorkspaceID:   to.Ptr("f8113ba8-dd81-443e-811a-b385340f3f05"),
				},
				DriverCores:                   to.Ptr[int32](2),
				DriverMemory:                  to.Ptr[int32](4),
				DynamicAllocationMaxExecutors: to.Ptr[int32](20),
				EndDateTime:                   to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-01-31T15:37:30.000Z"); return t }()),
				ExecutorCores:                 float64(4),
				ExecutorMemory:                to.Ptr[int32](8),
				IsDynamicAllocationEnabled:    to.Ptr(true),
				Item: &lakehouse.ItemReferenceByID{
					ReferenceType: to.Ptr(lakehouse.ItemReferenceTypeByID),
					ItemID:        to.Ptr("8cee7699-2e81-4121-9a53-cc9025046193"),
					WorkspaceID:   to.Ptr("f8113ba8-dd81-443e-811a-b385340f3f05"),
				},
				ItemName:                   to.Ptr("lh_itemName"),
				ItemType:                   to.Ptr(lakehouse.LivySessionItemTypeLakehouse),
				JobInstanceID:              to.Ptr("c2baabbd-5327-430c-87a6-ff4f98285601"),
				JobType:                    to.Ptr(lakehouse.JobTypeSparkBatch),
				LivyID:                     to.Ptr("9611f500-bf44-42e0-a0de-78dacb374398"),
				LivyName:                   to.Ptr("random_test_name_app"),
				LivySessionItemResourceURI: to.Ptr(""),
				MaxNumberOfAttempts:        to.Ptr[int32](1),
				NumExecutors:               to.Ptr[int32](10),
				OperationName:              to.Ptr("Batch Livy Run"),
				Origin:                     to.Ptr(lakehouse.OriginSubmittedJob),
				QueuedDuration: &lakehouse.Duration{
					TimeUnit: to.Ptr(lakehouse.TimeUnitSeconds),
					Value:    to.Ptr[float32](1),
				},
				RunningDuration: &lakehouse.Duration{
					TimeUnit: to.Ptr(lakehouse.TimeUnitSeconds),
					Value:    to.Ptr[float32](180),
				},
				RuntimeVersion:     to.Ptr("1.3"),
				SparkApplicationID: to.Ptr("application_1730933685452_0001"),
				StartDateTime:      to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-01-31T15:34:11.000Z"); return t }()),
				State:              to.Ptr(lakehouse.StateCancelled),
				SubmittedDateTime:  to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-01-31T15:32:03.000Z"); return t }()),
				Submitter: &lakehouse.Principal{
					Type: to.Ptr(lakehouse.PrincipalTypeUser),
					ID:   to.Ptr("6f23a8a6-d954-4550-b91a-4df73ccd0311"),
				},
				TotalDuration: &lakehouse.Duration{
					TimeUnit: to.Ptr(lakehouse.TimeUnitSeconds),
					Value:    to.Ptr[float32](360),
				},
			}},
	}

	testsuite.serverFactory.LivySessionsServer.NewListLivySessionsBetaPager = func(workspaceID string, lakehouseID string, beta bool, options *lakehouse.LivySessionsClientListLivySessionsBetaOptions) (resp azfake.PagerResponder[lakehouse.LivySessionsClientListLivySessionsBetaResponse]) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		testsuite.Require().Equal(exampleBeta, beta)
		resp = azfake.PagerResponder[lakehouse.LivySessionsClientListLivySessionsBetaResponse]{}
		resp.AddPage(http.StatusOK, lakehouse.LivySessionsClientListLivySessionsBetaResponse{LivySessions: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewLivySessionsClient()
	pager := client.NewListLivySessionsBetaPager(exampleWorkspaceID, exampleLakehouseID, exampleBeta, &lakehouse.LivySessionsClientListLivySessionsBetaOptions{SubmittedDateTime: nil,
		EndDateTime:       nil,
		SubmitterID:       nil,
		State:             nil,
		ContinuationToken: nil,
	})
	for pager.More() {
		nextResult, err := pager.NextPage(ctx)
		testsuite.Require().NoError(err, "Failed to advance page for example ")
		testsuite.Require().True(reflect.DeepEqual(exampleRes, nextResult.LivySessions))
		if err == nil {
			break
		}
	}
}

func (testsuite *FakeTestSuite) TestLivySessions_GetLivySession() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get a livy session example"},
	})
	var exampleWorkspaceID string
	var exampleLakehouseID string
	var exampleLivyID string
	exampleWorkspaceID = "f8113ba8-dd81-443e-811a-b385340f3f05"
	exampleLakehouseID = "8cee7699-2e81-4121-9a53-cc9025046193"
	exampleLivyID = "9611f500-bf44-42e0-a0de-78dacb374398"

	exampleRes := lakehouse.LivySession{
		AttemptNumber:      to.Ptr[int32](1),
		CancellationReason: to.Ptr("User cancelled the Spark batch"),
		CapacityID:         to.Ptr("3c0cd366-dc28-4b6d-a525-4d415a8666e7"),
		CreatorItem: &lakehouse.ItemReferenceByID{
			ReferenceType: to.Ptr(lakehouse.ItemReferenceTypeByID),
			ItemID:        to.Ptr("8cee7699-2e81-4121-9a53-cc9025046193"),
			WorkspaceID:   to.Ptr("f8113ba8-dd81-443e-811a-b385340f3f05"),
		},
		DriverCores:                   to.Ptr[int32](2),
		DriverMemory:                  to.Ptr[int32](4),
		DynamicAllocationMaxExecutors: to.Ptr[int32](20),
		EndDateTime:                   to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-01-31T15:37:30.000Z"); return t }()),
		ExecutorCores:                 float64(4),
		ExecutorMemory:                to.Ptr[int32](8),
		IsDynamicAllocationEnabled:    to.Ptr(true),
		Item: &lakehouse.ItemReferenceByID{
			ReferenceType: to.Ptr(lakehouse.ItemReferenceTypeByID),
			ItemID:        to.Ptr("8cee7699-2e81-4121-9a53-cc9025046193"),
			WorkspaceID:   to.Ptr("f8113ba8-dd81-443e-811a-b385340f3f05"),
		},
		ItemName:                   to.Ptr("lh_itemName"),
		ItemType:                   to.Ptr(lakehouse.LivySessionItemTypeLakehouse),
		JobInstanceID:              to.Ptr("c2baabbd-5327-430c-87a6-ff4f98285601"),
		JobType:                    to.Ptr(lakehouse.JobTypeSparkBatch),
		LivyID:                     to.Ptr("9611f500-bf44-42e0-a0de-78dacb374398"),
		LivyName:                   to.Ptr("random_test_name_app"),
		LivySessionItemResourceURI: to.Ptr(""),
		MaxNumberOfAttempts:        to.Ptr[int32](1),
		NumExecutors:               to.Ptr[int32](10),
		OperationName:              to.Ptr("Batch Livy Run"),
		Origin:                     to.Ptr(lakehouse.OriginSubmittedJob),
		QueuedDuration: &lakehouse.Duration{
			TimeUnit: to.Ptr(lakehouse.TimeUnitSeconds),
			Value:    to.Ptr[float32](1),
		},
		RunningDuration: &lakehouse.Duration{
			TimeUnit: to.Ptr(lakehouse.TimeUnitSeconds),
			Value:    to.Ptr[float32](180),
		},
		RuntimeVersion:     to.Ptr("1.3"),
		SparkApplicationID: to.Ptr("application_1730933685452_0001"),
		StartDateTime:      to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-01-31T15:34:11.000Z"); return t }()),
		State:              to.Ptr(lakehouse.StateCancelled),
		SubmittedDateTime:  to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2025-01-31T15:32:03.000Z"); return t }()),
		Submitter: &lakehouse.Principal{
			Type: to.Ptr(lakehouse.PrincipalTypeUser),
			ID:   to.Ptr("6f23a8a6-d954-4550-b91a-4df73ccd0311"),
		},
		TotalDuration: &lakehouse.Duration{
			TimeUnit: to.Ptr(lakehouse.TimeUnitSeconds),
			Value:    to.Ptr[float32](360),
		},
	}

	testsuite.serverFactory.LivySessionsServer.GetLivySession = func(ctx context.Context, workspaceID string, lakehouseID string, livyID string, options *lakehouse.LivySessionsClientGetLivySessionOptions) (resp azfake.Responder[lakehouse.LivySessionsClientGetLivySessionResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleLakehouseID, lakehouseID)
		testsuite.Require().Equal(exampleLivyID, livyID)
		resp = azfake.Responder[lakehouse.LivySessionsClientGetLivySessionResponse]{}
		resp.SetResponse(http.StatusOK, lakehouse.LivySessionsClientGetLivySessionResponse{LivySession: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewLivySessionsClient()
	res, err := client.GetLivySession(ctx, exampleWorkspaceID, exampleLakehouseID, exampleLivyID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.LivySession))
}
