// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License. See LICENSE in the project root for license information.
// Code generated by Microsoft (R) AutoRest Code Generator.
// Changes may cause incorrect behavior and will be lost if the code is regenerated.
// SPDX-License-Identifier: MIT

package environment_test

import (
	"context"
	"net/http"
	"testing"

	"github.com/Azure/azure-sdk-for-go/sdk/azcore"

	azfake "github.com/Azure/azure-sdk-for-go/sdk/azcore/fake"
	"github.com/Azure/azure-sdk-for-go/sdk/azcore/runtime"
	"github.com/Azure/azure-sdk-for-go/sdk/azcore/to"

	"reflect"
	"time"

	"github.com/stretchr/testify/suite"

	"github.com/microsoft/fabric-sdk-go/fabric"
	"github.com/microsoft/fabric-sdk-go/fabric/environment"
	"github.com/microsoft/fabric-sdk-go/fabric/environment/fake"
)

var err error

type FakeTestSuite struct {
	suite.Suite

	ctx  context.Context
	cred azcore.TokenCredential

	serverFactory *fake.ServerFactory
	clientFactory *environment.ClientFactory
}

func (testsuite *FakeTestSuite) SetupSuite() {
	testsuite.ctx = context.Background()
	testsuite.cred = &azfake.TokenCredential{}

	testsuite.serverFactory = &fake.ServerFactory{}
	testsuite.clientFactory, err = environment.NewClientFactory(testsuite.cred, nil, &fabric.ClientOptions{
		ClientOptions: azcore.ClientOptions{
			Transport: fake.NewServerFactoryTransport(testsuite.serverFactory),
		},
	})
	testsuite.Require().NoError(err, "Failed to create client factory")
}

func TestFakeTest(t *testing.T) {
	suite.Run(t, new(FakeTestSuite))
}

func (testsuite *FakeTestSuite) TestStaging_GetSparkComputePreview() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get environment staging spark compute example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var examplePreview bool
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "707cfd07-cbf1-41da-aad7-dd157ddb8c11"
	examplePreview = true

	exampleRes := environment.SparkComputePreview{
		DriverCores:  to.Ptr[int32](4),
		DriverMemory: to.Ptr("56g"),
		DynamicExecutorAllocation: &environment.DynamicExecutorAllocationProperties{
			Enabled:      to.Ptr(false),
			MaxExecutors: to.Ptr[int32](1),
			MinExecutors: to.Ptr[int32](1),
		},
		ExecutorCores:  to.Ptr[int32](4),
		ExecutorMemory: to.Ptr("56g"),
		InstancePool: &environment.InstancePool{
			Name: to.Ptr("MyWorkspacePool"),
			Type: to.Ptr(environment.CustomPoolTypeWorkspace),
			ID:   to.Ptr("78942136-106c-4f3e-80fc-7ff4eae11603"),
		},
		RuntimeVersion: to.Ptr("1.2"),
		SparkProperties: map[string]any{
			"spark.acls.enable": "false",
		},
	}

	testsuite.serverFactory.StagingServer.GetSparkComputePreview = func(ctx context.Context, workspaceID string, environmentID string, preview bool, options *environment.StagingClientGetSparkComputePreviewOptions) (resp azfake.Responder[environment.StagingClientGetSparkComputePreviewResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().Equal(examplePreview, preview)
		resp = azfake.Responder[environment.StagingClientGetSparkComputePreviewResponse]{}
		resp.SetResponse(http.StatusOK, environment.StagingClientGetSparkComputePreviewResponse{SparkComputePreview: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewStagingClient()
	res, err := client.GetSparkComputePreview(ctx, exampleWorkspaceID, exampleEnvironmentID, examplePreview, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.SparkComputePreview))
}

func (testsuite *FakeTestSuite) TestStaging_UpdateSparkComputePreview() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Update environment staging spark compute example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var examplePreview bool
	var exampleUpdateEnvironmentSparkComputeRequest environment.UpdateEnvironmentSparkComputeRequestPreview
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "707cfd07-cbf1-41da-aad7-dd157ddb8c11"
	examplePreview = true
	exampleUpdateEnvironmentSparkComputeRequest = environment.UpdateEnvironmentSparkComputeRequestPreview{
		DriverCores:  to.Ptr[int32](4),
		DriverMemory: to.Ptr("56g"),
		DynamicExecutorAllocation: &environment.DynamicExecutorAllocationProperties{
			Enabled:      to.Ptr(false),
			MaxExecutors: to.Ptr[int32](1),
			MinExecutors: to.Ptr[int32](1),
		},
		ExecutorCores:  to.Ptr[int32](4),
		ExecutorMemory: to.Ptr("56g"),
		InstancePool: &environment.InstancePool{
			Name: to.Ptr("MyWorkspacePool"),
			Type: to.Ptr(environment.CustomPoolTypeWorkspace),
		},
		RuntimeVersion: to.Ptr("1.2"),
		SparkProperties: map[string]any{
			"spark.acls.enable": "false",
			"spark.admin.acls":  nil,
		},
	}

	exampleRes := environment.SparkComputePreview{
		DriverCores:  to.Ptr[int32](4),
		DriverMemory: to.Ptr("56g"),
		DynamicExecutorAllocation: &environment.DynamicExecutorAllocationProperties{
			Enabled:      to.Ptr(false),
			MaxExecutors: to.Ptr[int32](1),
			MinExecutors: to.Ptr[int32](1),
		},
		ExecutorCores:  to.Ptr[int32](4),
		ExecutorMemory: to.Ptr("56g"),
		InstancePool: &environment.InstancePool{
			Name: to.Ptr("MyWorkspacePool"),
			Type: to.Ptr(environment.CustomPoolTypeWorkspace),
			ID:   to.Ptr("78942136-106c-4f3e-80fc-7ff4eae11603"),
		},
		RuntimeVersion: to.Ptr("1.2"),
		SparkProperties: map[string]any{
			"spark.acls.enable": "false",
		},
	}

	testsuite.serverFactory.StagingServer.UpdateSparkComputePreview = func(ctx context.Context, workspaceID string, environmentID string, preview bool, updateEnvironmentSparkComputeRequest environment.UpdateEnvironmentSparkComputeRequestPreview, options *environment.StagingClientUpdateSparkComputePreviewOptions) (resp azfake.Responder[environment.StagingClientUpdateSparkComputePreviewResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().Equal(examplePreview, preview)
		testsuite.Require().True(reflect.DeepEqual(exampleUpdateEnvironmentSparkComputeRequest, updateEnvironmentSparkComputeRequest))
		resp = azfake.Responder[environment.StagingClientUpdateSparkComputePreviewResponse]{}
		resp.SetResponse(http.StatusOK, environment.StagingClientUpdateSparkComputePreviewResponse{SparkComputePreview: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewStagingClient()
	res, err := client.UpdateSparkComputePreview(ctx, exampleWorkspaceID, exampleEnvironmentID, examplePreview, exampleUpdateEnvironmentSparkComputeRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.SparkComputePreview))
}

func (testsuite *FakeTestSuite) TestStaging_GetSparkCompute() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get environment staging spark compute example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var examplePreview bool
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "707cfd07-cbf1-41da-aad7-dd157ddb8c11"
	examplePreview = false

	exampleRes := environment.SparkCompute{
		DriverCores:  to.Ptr[int32](4),
		DriverMemory: to.Ptr(environment.CustomPoolMemoryFiftySixG),
		DynamicExecutorAllocation: &environment.DynamicExecutorAllocationProperties{
			Enabled:      to.Ptr(false),
			MaxExecutors: to.Ptr[int32](1),
			MinExecutors: to.Ptr[int32](1),
		},
		ExecutorCores:  to.Ptr[int32](4),
		ExecutorMemory: to.Ptr(environment.CustomPoolMemoryFiftySixG),
		InstancePool: &environment.InstancePool{
			Name: to.Ptr("MyWorkspacePool"),
			Type: to.Ptr(environment.CustomPoolTypeWorkspace),
			ID:   to.Ptr("78942136-106c-4f3e-80fc-7ff4eae11603"),
		},
		RuntimeVersion: to.Ptr("1.2"),
		SparkProperties: []environment.SparkProperty{
			{
				Key:   to.Ptr("spark.acls.enable"),
				Value: to.Ptr("false"),
			}},
	}

	testsuite.serverFactory.StagingServer.GetSparkCompute = func(ctx context.Context, workspaceID string, environmentID string, preview bool, options *environment.StagingClientGetSparkComputeOptions) (resp azfake.Responder[environment.StagingClientGetSparkComputeResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().Equal(examplePreview, preview)
		resp = azfake.Responder[environment.StagingClientGetSparkComputeResponse]{}
		resp.SetResponse(http.StatusOK, environment.StagingClientGetSparkComputeResponse{SparkCompute: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewStagingClient()
	res, err := client.GetSparkCompute(ctx, exampleWorkspaceID, exampleEnvironmentID, examplePreview, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.SparkCompute))
}

func (testsuite *FakeTestSuite) TestStaging_UpdateSparkCompute() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Update environment staging spark compute example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var examplePreview bool
	var exampleUpdateEnvironmentSparkComputeRequest environment.UpdateEnvironmentSparkComputeRequest
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "707cfd07-cbf1-41da-aad7-dd157ddb8c11"
	examplePreview = false
	exampleUpdateEnvironmentSparkComputeRequest = environment.UpdateEnvironmentSparkComputeRequest{
		DriverCores:  to.Ptr[int32](4),
		DriverMemory: to.Ptr(environment.CustomPoolMemoryFiftySixG),
		DynamicExecutorAllocation: &environment.DynamicExecutorAllocationProperties{
			Enabled:      to.Ptr(false),
			MaxExecutors: to.Ptr[int32](1),
			MinExecutors: to.Ptr[int32](1),
		},
		ExecutorCores:  to.Ptr[int32](4),
		ExecutorMemory: to.Ptr(environment.CustomPoolMemoryFiftySixG),
		InstancePool: &environment.InstancePool{
			Name: to.Ptr("MyWorkspacePool"),
			Type: to.Ptr(environment.CustomPoolTypeWorkspace),
		},
		RuntimeVersion: to.Ptr("1.2"),
		SparkProperties: []environment.SparkProperty{
			{
				Key:   to.Ptr("spark.acls.enable"),
				Value: to.Ptr("false"),
			},
			{
				Key: to.Ptr("spark.admin.acls"),
			}},
	}

	exampleRes := environment.SparkCompute{
		DriverCores:  to.Ptr[int32](4),
		DriverMemory: to.Ptr(environment.CustomPoolMemoryFiftySixG),
		DynamicExecutorAllocation: &environment.DynamicExecutorAllocationProperties{
			Enabled:      to.Ptr(false),
			MaxExecutors: to.Ptr[int32](1),
			MinExecutors: to.Ptr[int32](1),
		},
		ExecutorCores:  to.Ptr[int32](4),
		ExecutorMemory: to.Ptr(environment.CustomPoolMemoryFiftySixG),
		InstancePool: &environment.InstancePool{
			Name: to.Ptr("MyWorkspacePool"),
			Type: to.Ptr(environment.CustomPoolTypeWorkspace),
			ID:   to.Ptr("78942136-106c-4f3e-80fc-7ff4eae11603"),
		},
		RuntimeVersion: to.Ptr("1.2"),
		SparkProperties: []environment.SparkProperty{
			{
				Key:   to.Ptr("spark.acls.enable"),
				Value: to.Ptr("false"),
			}},
	}

	testsuite.serverFactory.StagingServer.UpdateSparkCompute = func(ctx context.Context, workspaceID string, environmentID string, preview bool, updateEnvironmentSparkComputeRequest environment.UpdateEnvironmentSparkComputeRequest, options *environment.StagingClientUpdateSparkComputeOptions) (resp azfake.Responder[environment.StagingClientUpdateSparkComputeResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().Equal(examplePreview, preview)
		testsuite.Require().True(reflect.DeepEqual(exampleUpdateEnvironmentSparkComputeRequest, updateEnvironmentSparkComputeRequest))
		resp = azfake.Responder[environment.StagingClientUpdateSparkComputeResponse]{}
		resp.SetResponse(http.StatusOK, environment.StagingClientUpdateSparkComputeResponse{SparkCompute: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewStagingClient()
	res, err := client.UpdateSparkCompute(ctx, exampleWorkspaceID, exampleEnvironmentID, examplePreview, exampleUpdateEnvironmentSparkComputeRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.SparkCompute))

	// From example
	ctx = runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Update environment staging spark compute instance pool using pool ID example"},
	})
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "707cfd07-cbf1-41da-aad7-dd157ddb8c11"
	examplePreview = false
	exampleUpdateEnvironmentSparkComputeRequest = environment.UpdateEnvironmentSparkComputeRequest{
		InstancePool: &environment.InstancePool{
			ID: to.Ptr("78942136-106c-4f3e-80fc-7ff4eae11603"),
		},
	}

	exampleRes = environment.SparkCompute{
		DriverCores:  to.Ptr[int32](4),
		DriverMemory: to.Ptr(environment.CustomPoolMemoryFiftySixG),
		DynamicExecutorAllocation: &environment.DynamicExecutorAllocationProperties{
			Enabled:      to.Ptr(false),
			MaxExecutors: to.Ptr[int32](1),
			MinExecutors: to.Ptr[int32](1),
		},
		ExecutorCores:  to.Ptr[int32](4),
		ExecutorMemory: to.Ptr(environment.CustomPoolMemoryFiftySixG),
		InstancePool: &environment.InstancePool{
			Name: to.Ptr("MyWorkspacePool"),
			Type: to.Ptr(environment.CustomPoolTypeWorkspace),
			ID:   to.Ptr("78942136-106c-4f3e-80fc-7ff4eae11603"),
		},
		RuntimeVersion: to.Ptr("1.2"),
		SparkProperties: []environment.SparkProperty{
			{
				Key:   to.Ptr("spark.acls.enable"),
				Value: to.Ptr("false"),
			}},
	}

	testsuite.serverFactory.StagingServer.UpdateSparkCompute = func(ctx context.Context, workspaceID string, environmentID string, preview bool, updateEnvironmentSparkComputeRequest environment.UpdateEnvironmentSparkComputeRequest, options *environment.StagingClientUpdateSparkComputeOptions) (resp azfake.Responder[environment.StagingClientUpdateSparkComputeResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().Equal(examplePreview, preview)
		testsuite.Require().True(reflect.DeepEqual(exampleUpdateEnvironmentSparkComputeRequest, updateEnvironmentSparkComputeRequest))
		resp = azfake.Responder[environment.StagingClientUpdateSparkComputeResponse]{}
		resp.SetResponse(http.StatusOK, environment.StagingClientUpdateSparkComputeResponse{SparkCompute: exampleRes}, nil)
		return
	}

	res, err = client.UpdateSparkCompute(ctx, exampleWorkspaceID, exampleEnvironmentID, examplePreview, exampleUpdateEnvironmentSparkComputeRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.SparkCompute))
}

func (testsuite *FakeTestSuite) TestStaging_ListLibraries() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get environment staging libraries example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var examplePreview bool
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"
	examplePreview = false

	exampleRes := environment.Libraries{
		ContinuationToken: to.Ptr("null"),
		ContinuationURI:   to.Ptr("null"),
		Libraries: []environment.LibraryClassification{
			&environment.CustomLibrary{
				Name:        to.Ptr("samplewheel-0.18.0-py2.py3-none-any.whl"),
				LibraryType: to.Ptr(environment.LibraryTypeCustom),
			},
			&environment.CustomLibrary{
				Name:        to.Ptr("samplepython.py"),
				LibraryType: to.Ptr(environment.LibraryTypeCustom),
			},
			&environment.CustomLibrary{
				Name:        to.Ptr("samplejar.jar"),
				LibraryType: to.Ptr(environment.LibraryTypeCustom),
			},
			&environment.CustomLibrary{
				Name:        to.Ptr("sampleR.tar.gz"),
				LibraryType: to.Ptr(environment.LibraryTypeCustom),
			},
			&environment.ExternalLibrary{
				Name:        to.Ptr("fuzzywuzzy"),
				LibraryType: to.Ptr(environment.LibraryTypeExternal),
				Version:     to.Ptr("0.0.1"),
			},
			&environment.ExternalLibrary{
				Name:        to.Ptr("matplotlib"),
				LibraryType: to.Ptr(environment.LibraryTypeExternal),
				Version:     to.Ptr("0.0.1"),
			}},
	}

	testsuite.serverFactory.StagingServer.NewListLibrariesPager = func(workspaceID string, environmentID string, preview bool, options *environment.StagingClientListLibrariesOptions) (resp azfake.PagerResponder[environment.StagingClientListLibrariesResponse]) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().Equal(examplePreview, preview)
		resp = azfake.PagerResponder[environment.StagingClientListLibrariesResponse]{}
		resp.AddPage(http.StatusOK, environment.StagingClientListLibrariesResponse{Libraries: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewStagingClient()
	pager := client.NewListLibrariesPager(exampleWorkspaceID, exampleEnvironmentID, examplePreview, &environment.StagingClientListLibrariesOptions{ContinuationToken: nil})
	for pager.More() {
		nextResult, err := pager.NextPage(ctx)
		testsuite.Require().NoError(err, "Failed to advance page for example ")
		testsuite.Require().True(reflect.DeepEqual(exampleRes, nextResult.Libraries))
		if err == nil {
			break
		}
	}
}

func (testsuite *FakeTestSuite) TestStaging_UploadCustomLibraryPreview() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Upload environment staging libraries example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"

	testsuite.serverFactory.StagingServer.UploadCustomLibraryPreview = func(ctx context.Context, workspaceID string, environmentID string, options *environment.StagingClientUploadCustomLibraryPreviewOptions) (resp azfake.Responder[environment.StagingClientUploadCustomLibraryPreviewResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		resp = azfake.Responder[environment.StagingClientUploadCustomLibraryPreviewResponse]{}
		resp.SetResponse(http.StatusOK, environment.StagingClientUploadCustomLibraryPreviewResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewStagingClient()
	_, err = client.UploadCustomLibraryPreview(ctx, exampleWorkspaceID, exampleEnvironmentID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestStaging_DeleteCustomLibraryPreview() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Delete environment staging libraries example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var exampleLibraryToDelete string
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"
	exampleLibraryToDelete = "samplelibrary.jar"

	testsuite.serverFactory.StagingServer.DeleteCustomLibraryPreview = func(ctx context.Context, workspaceID string, environmentID string, libraryToDelete string, options *environment.StagingClientDeleteCustomLibraryPreviewOptions) (resp azfake.Responder[environment.StagingClientDeleteCustomLibraryPreviewResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().Equal(exampleLibraryToDelete, libraryToDelete)
		resp = azfake.Responder[environment.StagingClientDeleteCustomLibraryPreviewResponse]{}
		resp.SetResponse(http.StatusOK, environment.StagingClientDeleteCustomLibraryPreviewResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewStagingClient()
	_, err = client.DeleteCustomLibraryPreview(ctx, exampleWorkspaceID, exampleEnvironmentID, exampleLibraryToDelete, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestStaging_ListLibrariesPreview() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get environment staging libraries example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var examplePreview bool
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"
	examplePreview = true

	exampleRes := environment.LibrariesPreview{
		CustomLibraries: &environment.CustomLibraries{
			JarFiles: []string{
				"samplejar.jar"},
			PyFiles: []string{
				"samplepython.py"},
			RTarFiles: []string{
				"sampleR.tar.gz"},
			WheelFiles: []string{
				"samplewheel-0.18.0-py2.py3-none-any.whl"},
		},
		EnvironmentYml: to.Ptr("name: sample-environment\ndependencies:\n  - fuzzywuzzy==0.0.1\n  - matplotlib==0.0.1"),
	}

	testsuite.serverFactory.StagingServer.ListLibrariesPreview = func(ctx context.Context, workspaceID string, environmentID string, preview bool, options *environment.StagingClientListLibrariesPreviewOptions) (resp azfake.Responder[environment.StagingClientListLibrariesPreviewResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().Equal(examplePreview, preview)
		resp = azfake.Responder[environment.StagingClientListLibrariesPreviewResponse]{}
		resp.SetResponse(http.StatusOK, environment.StagingClientListLibrariesPreviewResponse{LibrariesPreview: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewStagingClient()
	res, err := client.ListLibrariesPreview(ctx, exampleWorkspaceID, exampleEnvironmentID, examplePreview, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.LibrariesPreview))
}

func (testsuite *FakeTestSuite) TestStaging_UploadCustomLibrary() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Upload environment staging libraries example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var exampleLibraryName string
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"
	exampleLibraryName = "samplelibrary.jar"

	testsuite.serverFactory.StagingServer.UploadCustomLibrary = func(ctx context.Context, workspaceID string, environmentID string, libraryName string, options *environment.StagingClientUploadCustomLibraryOptions) (resp azfake.Responder[environment.StagingClientUploadCustomLibraryResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().Equal(exampleLibraryName, libraryName)
		resp = azfake.Responder[environment.StagingClientUploadCustomLibraryResponse]{}
		resp.SetResponse(http.StatusOK, environment.StagingClientUploadCustomLibraryResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewStagingClient()
	_, err = client.UploadCustomLibrary(ctx, exampleWorkspaceID, exampleEnvironmentID, exampleLibraryName, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestStaging_DeleteCustomLibrary() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Delete environment staging libraries example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var exampleLibraryName string
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"
	exampleLibraryName = "samplelibrary.jar"

	testsuite.serverFactory.StagingServer.DeleteCustomLibrary = func(ctx context.Context, workspaceID string, environmentID string, libraryName string, options *environment.StagingClientDeleteCustomLibraryOptions) (resp azfake.Responder[environment.StagingClientDeleteCustomLibraryResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().Equal(exampleLibraryName, libraryName)
		resp = azfake.Responder[environment.StagingClientDeleteCustomLibraryResponse]{}
		resp.SetResponse(http.StatusOK, environment.StagingClientDeleteCustomLibraryResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewStagingClient()
	_, err = client.DeleteCustomLibrary(ctx, exampleWorkspaceID, exampleEnvironmentID, exampleLibraryName, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestStaging_RemoveExternalLibrary() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Delete an external library from environment example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var exampleRemoveExternalLibraryRequest environment.RemoveExternalLibrariesRequest
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"
	exampleRemoveExternalLibraryRequest = environment.RemoveExternalLibrariesRequest{
		Name:    to.Ptr("fuzzywuzzy"),
		Version: to.Ptr("0.0.1"),
	}

	testsuite.serverFactory.StagingServer.RemoveExternalLibrary = func(ctx context.Context, workspaceID string, environmentID string, removeExternalLibraryRequest environment.RemoveExternalLibrariesRequest, options *environment.StagingClientRemoveExternalLibraryOptions) (resp azfake.Responder[environment.StagingClientRemoveExternalLibraryResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().True(reflect.DeepEqual(exampleRemoveExternalLibraryRequest, removeExternalLibraryRequest))
		resp = azfake.Responder[environment.StagingClientRemoveExternalLibraryResponse]{}
		resp.SetResponse(http.StatusOK, environment.StagingClientRemoveExternalLibraryResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewStagingClient()
	_, err = client.RemoveExternalLibrary(ctx, exampleWorkspaceID, exampleEnvironmentID, exampleRemoveExternalLibraryRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestStaging_ImportExternalLibraries() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Upload environment staging external libraries example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"

	testsuite.serverFactory.StagingServer.ImportExternalLibraries = func(ctx context.Context, workspaceID string, environmentID string, options *environment.StagingClientImportExternalLibrariesOptions) (resp azfake.Responder[environment.StagingClientImportExternalLibrariesResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		resp = azfake.Responder[environment.StagingClientImportExternalLibrariesResponse]{}
		resp.SetResponse(http.StatusOK, environment.StagingClientImportExternalLibrariesResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewStagingClient()
	_, err = client.ImportExternalLibraries(ctx, exampleWorkspaceID, exampleEnvironmentID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestStaging_ExportExternalLibraries() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Export staging external libraries in environment.yml example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"

	testsuite.serverFactory.StagingServer.ExportExternalLibraries = func(ctx context.Context, workspaceID string, environmentID string, options *environment.StagingClientExportExternalLibrariesOptions) (resp azfake.Responder[environment.StagingClientExportExternalLibrariesResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		resp = azfake.Responder[environment.StagingClientExportExternalLibrariesResponse]{}
		resp.SetResponse(http.StatusOK, environment.StagingClientExportExternalLibrariesResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewStagingClient()
	_, err = client.ExportExternalLibraries(ctx, exampleWorkspaceID, exampleEnvironmentID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestPublished_GetSparkComputePreview() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get environment Spark compute example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var examplePreview bool
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "707cfd07-cbf1-41da-aad7-dd157ddb8c11"
	examplePreview = true

	exampleRes := environment.SparkComputePreview{
		DriverCores:  to.Ptr[int32](4),
		DriverMemory: to.Ptr("56g"),
		DynamicExecutorAllocation: &environment.DynamicExecutorAllocationProperties{
			Enabled:      to.Ptr(false),
			MaxExecutors: to.Ptr[int32](1),
			MinExecutors: to.Ptr[int32](1),
		},
		ExecutorCores:  to.Ptr[int32](4),
		ExecutorMemory: to.Ptr("56g"),
		InstancePool: &environment.InstancePool{
			Name: to.Ptr("MyWorkspacePool"),
			Type: to.Ptr(environment.CustomPoolTypeWorkspace),
			ID:   to.Ptr("78942136-106c-4f3e-80fc-7ff4eae11603"),
		},
		RuntimeVersion: to.Ptr("1.2"),
		SparkProperties: map[string]any{
			"spark.acls.enable": "false",
		},
	}

	testsuite.serverFactory.PublishedServer.GetSparkComputePreview = func(ctx context.Context, workspaceID string, environmentID string, preview bool, options *environment.PublishedClientGetSparkComputePreviewOptions) (resp azfake.Responder[environment.PublishedClientGetSparkComputePreviewResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().Equal(examplePreview, preview)
		resp = azfake.Responder[environment.PublishedClientGetSparkComputePreviewResponse]{}
		resp.SetResponse(http.StatusOK, environment.PublishedClientGetSparkComputePreviewResponse{SparkComputePreview: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewPublishedClient()
	res, err := client.GetSparkComputePreview(ctx, exampleWorkspaceID, exampleEnvironmentID, examplePreview, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.SparkComputePreview))
}

func (testsuite *FakeTestSuite) TestPublished_GetSparkCompute() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get environment Spark compute example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var examplePreview bool
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "707cfd07-cbf1-41da-aad7-dd157ddb8c11"
	examplePreview = false

	exampleRes := environment.SparkCompute{
		DriverCores:  to.Ptr[int32](4),
		DriverMemory: to.Ptr(environment.CustomPoolMemoryFiftySixG),
		DynamicExecutorAllocation: &environment.DynamicExecutorAllocationProperties{
			Enabled:      to.Ptr(false),
			MaxExecutors: to.Ptr[int32](1),
			MinExecutors: to.Ptr[int32](1),
		},
		ExecutorCores:  to.Ptr[int32](4),
		ExecutorMemory: to.Ptr(environment.CustomPoolMemoryFiftySixG),
		InstancePool: &environment.InstancePool{
			Name: to.Ptr("MyWorkspacePool"),
			Type: to.Ptr(environment.CustomPoolTypeWorkspace),
			ID:   to.Ptr("78942136-106c-4f3e-80fc-7ff4eae11603"),
		},
		RuntimeVersion: to.Ptr("1.2"),
		SparkProperties: []environment.SparkProperty{
			{
				Key:   to.Ptr("spark.acls.enable"),
				Value: to.Ptr("false"),
			}},
	}

	testsuite.serverFactory.PublishedServer.GetSparkCompute = func(ctx context.Context, workspaceID string, environmentID string, preview bool, options *environment.PublishedClientGetSparkComputeOptions) (resp azfake.Responder[environment.PublishedClientGetSparkComputeResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().Equal(examplePreview, preview)
		resp = azfake.Responder[environment.PublishedClientGetSparkComputeResponse]{}
		resp.SetResponse(http.StatusOK, environment.PublishedClientGetSparkComputeResponse{SparkCompute: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewPublishedClient()
	res, err := client.GetSparkCompute(ctx, exampleWorkspaceID, exampleEnvironmentID, examplePreview, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.SparkCompute))
}

func (testsuite *FakeTestSuite) TestPublished_ListLibraries() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get environment published libraries example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var examplePreview bool
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"
	examplePreview = false

	exampleRes := environment.Libraries{
		ContinuationToken: to.Ptr("null"),
		ContinuationURI:   to.Ptr("null"),
		Libraries: []environment.LibraryClassification{
			&environment.CustomLibrary{
				Name:        to.Ptr("samplewheel-0.18.0-py2.py3-none-any.whl"),
				LibraryType: to.Ptr(environment.LibraryTypeCustom),
			},
			&environment.CustomLibrary{
				Name:        to.Ptr("samplepython.py"),
				LibraryType: to.Ptr(environment.LibraryTypeCustom),
			},
			&environment.CustomLibrary{
				Name:        to.Ptr("samplejar.jar"),
				LibraryType: to.Ptr(environment.LibraryTypeCustom),
			},
			&environment.CustomLibrary{
				Name:        to.Ptr("sampleR.tar.gz"),
				LibraryType: to.Ptr(environment.LibraryTypeCustom),
			},
			&environment.ExternalLibrary{
				Name:        to.Ptr("fuzzywuzzy"),
				LibraryType: to.Ptr(environment.LibraryTypeExternal),
				Version:     to.Ptr("0.0.1"),
			},
			&environment.ExternalLibrary{
				Name:        to.Ptr("matplotlib"),
				LibraryType: to.Ptr(environment.LibraryTypeExternal),
				Version:     to.Ptr("0.0.1"),
			}},
	}

	testsuite.serverFactory.PublishedServer.NewListLibrariesPager = func(workspaceID string, environmentID string, preview bool, options *environment.PublishedClientListLibrariesOptions) (resp azfake.PagerResponder[environment.PublishedClientListLibrariesResponse]) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().Equal(examplePreview, preview)
		resp = azfake.PagerResponder[environment.PublishedClientListLibrariesResponse]{}
		resp.AddPage(http.StatusOK, environment.PublishedClientListLibrariesResponse{Libraries: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewPublishedClient()
	pager := client.NewListLibrariesPager(exampleWorkspaceID, exampleEnvironmentID, examplePreview, &environment.PublishedClientListLibrariesOptions{ContinuationToken: nil})
	for pager.More() {
		nextResult, err := pager.NextPage(ctx)
		testsuite.Require().NoError(err, "Failed to advance page for example ")
		testsuite.Require().True(reflect.DeepEqual(exampleRes, nextResult.Libraries))
		if err == nil {
			break
		}
	}
}

func (testsuite *FakeTestSuite) TestPublished_ListLibrariesPreview() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get environment published libraries example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var examplePreview bool
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"
	examplePreview = true

	exampleRes := environment.LibrariesPreview{
		CustomLibraries: &environment.CustomLibraries{
			JarFiles: []string{
				"samplejar.jar"},
			PyFiles: []string{
				"samplepython.py"},
			RTarFiles: []string{
				"sampleR.tar.gz"},
			WheelFiles: []string{
				"samplewheel-0.18.0-py2.py3-none-any.whl"},
		},
		EnvironmentYml: to.Ptr("name: sample-environment\ndependencies:\n  - fuzzywuzzy==0.0.1\n  - matplotlib==0.0.1"),
	}

	testsuite.serverFactory.PublishedServer.ListLibrariesPreview = func(ctx context.Context, workspaceID string, environmentID string, preview bool, options *environment.PublishedClientListLibrariesPreviewOptions) (resp azfake.Responder[environment.PublishedClientListLibrariesPreviewResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().Equal(examplePreview, preview)
		resp = azfake.Responder[environment.PublishedClientListLibrariesPreviewResponse]{}
		resp.SetResponse(http.StatusOK, environment.PublishedClientListLibrariesPreviewResponse{LibrariesPreview: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewPublishedClient()
	res, err := client.ListLibrariesPreview(ctx, exampleWorkspaceID, exampleEnvironmentID, examplePreview, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.LibrariesPreview))
}

func (testsuite *FakeTestSuite) TestPublished_ExportExternalLibraries() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Export published external libraries in environment.yml example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"

	testsuite.serverFactory.PublishedServer.ExportExternalLibraries = func(ctx context.Context, workspaceID string, environmentID string, options *environment.PublishedClientExportExternalLibrariesOptions) (resp azfake.Responder[environment.PublishedClientExportExternalLibrariesResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		resp = azfake.Responder[environment.PublishedClientExportExternalLibrariesResponse]{}
		resp.SetResponse(http.StatusOK, environment.PublishedClientExportExternalLibrariesResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewPublishedClient()
	_, err = client.ExportExternalLibraries(ctx, exampleWorkspaceID, exampleEnvironmentID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestItems_ListEnvironments() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"List environments in workspace example"},
	})
	var exampleWorkspaceID string
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"

	exampleRes := environment.Environments{
		Value: []environment.Environment{
			{
				Type:        to.Ptr(environment.ItemTypeEnvironment),
				Description: to.Ptr("A environment description."),
				DisplayName: to.Ptr("Environment_1"),
				ID:          to.Ptr("3546052c-ae64-4526-b1a8-52af7761426f"),
				WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
				Properties: &environment.Properties{
					PublishDetails: &environment.PublishDetails{
						ComponentPublishInfo: &environment.ComponentPublishInfo{
							SparkLibraries: &environment.SparkLibraries{
								State: to.Ptr(environment.PublishStateFailed),
							},
							SparkSettings: &environment.SparkSettings{
								State: to.Ptr(environment.PublishStateSuccess),
							},
						},
						EndTime:       to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2024-03-30T14:48:09.069Z"); return t }()),
						StartTime:     to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2024-03-30T14:17:09.069Z"); return t }()),
						State:         to.Ptr(environment.PublishStateFailed),
						TargetVersion: to.Ptr("14ece8b5-68a1-4130-a9e7-074c04537588"),
					},
				},
			},
			{
				Type:        to.Ptr(environment.ItemTypeEnvironment),
				Description: to.Ptr("A environment description."),
				DisplayName: to.Ptr("Environment_2"),
				ID:          to.Ptr("a8a1bffa-7eea-49dc-a1d2-6281c1d031f1"),
				WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
				Properties: &environment.Properties{
					PublishDetails: &environment.PublishDetails{
						ComponentPublishInfo: &environment.ComponentPublishInfo{
							SparkLibraries: &environment.SparkLibraries{
								State: to.Ptr(environment.PublishStateSuccess),
							},
							SparkSettings: &environment.SparkSettings{
								State: to.Ptr(environment.PublishStateSuccess),
							},
						},
						EndTime:       to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2024-03-29T14:48:09.069Z"); return t }()),
						StartTime:     to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2024-03-29T14:17:09.069Z"); return t }()),
						State:         to.Ptr(environment.PublishStateSuccess),
						TargetVersion: to.Ptr("46838a80-5450-4414-bea0-40fb6f3e0c0d"),
					},
				},
			}},
	}

	testsuite.serverFactory.ItemsServer.NewListEnvironmentsPager = func(workspaceID string, options *environment.ItemsClientListEnvironmentsOptions) (resp azfake.PagerResponder[environment.ItemsClientListEnvironmentsResponse]) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		resp = azfake.PagerResponder[environment.ItemsClientListEnvironmentsResponse]{}
		resp.AddPage(http.StatusOK, environment.ItemsClientListEnvironmentsResponse{Environments: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	pager := client.NewListEnvironmentsPager(exampleWorkspaceID, &environment.ItemsClientListEnvironmentsOptions{ContinuationToken: nil})
	for pager.More() {
		nextResult, err := pager.NextPage(ctx)
		testsuite.Require().NoError(err, "Failed to advance page for example ")
		testsuite.Require().True(reflect.DeepEqual(exampleRes, nextResult.Environments))
		if err == nil {
			break
		}
	}
}

func (testsuite *FakeTestSuite) TestItems_CreateEnvironment() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Create an environment example"},
	})
	var exampleWorkspaceID string
	var exampleCreateEnvironmentRequest environment.CreateEnvironmentRequest
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleCreateEnvironmentRequest = environment.CreateEnvironmentRequest{
		Description: to.Ptr("An environment description."),
		DisplayName: to.Ptr("Environment_1"),
	}

	testsuite.serverFactory.ItemsServer.BeginCreateEnvironment = func(ctx context.Context, workspaceID string, createEnvironmentRequest environment.CreateEnvironmentRequest, options *environment.ItemsClientBeginCreateEnvironmentOptions) (resp azfake.PollerResponder[environment.ItemsClientCreateEnvironmentResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().True(reflect.DeepEqual(exampleCreateEnvironmentRequest, createEnvironmentRequest))
		resp = azfake.PollerResponder[environment.ItemsClientCreateEnvironmentResponse]{}
		resp.SetTerminalResponse(http.StatusCreated, environment.ItemsClientCreateEnvironmentResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	poller, err := client.BeginCreateEnvironment(ctx, exampleWorkspaceID, exampleCreateEnvironmentRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	_, err = poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")

	// From example
	ctx = runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Create an environment with public definition example"},
	})
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleCreateEnvironmentRequest = environment.CreateEnvironmentRequest{
		Description: to.Ptr("An environment description."),
		Definition: &environment.Definition{
			Parts: []environment.DefinitionPart{
				{
					Path:        to.Ptr("Libraries/CustomLibraries/samplelibrary.jar"),
					Payload:     to.Ptr("eyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("Libraries/CustomLibraries/samplepython.py"),
					Payload:     to.Ptr("FyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("Libraries/CustomLibraries/samplewheel-0.18.0-py2.py3-none-any.whl"),
					Payload:     to.Ptr("LyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("Libraries/CustomLibraries/sampleR.tar.gz"),
					Payload:     to.Ptr("ZyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("Libraries/PublicLibraries/environment.yml"),
					Payload:     to.Ptr("IyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("Setting/Sparkcompute.yml"),
					Payload:     to.Ptr("GyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr(".platform"),
					Payload:     to.Ptr("ZG90UGxhdGZvcm1CYXNlNjRTdHJpbmc"),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				}},
		},
		DisplayName: to.Ptr("Environment_1"),
	}

	testsuite.serverFactory.ItemsServer.BeginCreateEnvironment = func(ctx context.Context, workspaceID string, createEnvironmentRequest environment.CreateEnvironmentRequest, options *environment.ItemsClientBeginCreateEnvironmentOptions) (resp azfake.PollerResponder[environment.ItemsClientCreateEnvironmentResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().True(reflect.DeepEqual(exampleCreateEnvironmentRequest, createEnvironmentRequest))
		resp = azfake.PollerResponder[environment.ItemsClientCreateEnvironmentResponse]{}
		resp.SetTerminalResponse(http.StatusCreated, environment.ItemsClientCreateEnvironmentResponse{}, nil)
		return
	}

	poller, err = client.BeginCreateEnvironment(ctx, exampleWorkspaceID, exampleCreateEnvironmentRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	_, err = poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")
}

func (testsuite *FakeTestSuite) TestItems_GetEnvironment() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get Environment Item example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"

	exampleRes := environment.Environment{
		Type:        to.Ptr(environment.ItemTypeEnvironment),
		Description: to.Ptr("An Environment description"),
		DisplayName: to.Ptr("Environment_1"),
		ID:          to.Ptr("5b218778-e7a5-4d73-8187-f10824047715"),
		WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
		Properties: &environment.Properties{
			PublishDetails: &environment.PublishDetails{
				ComponentPublishInfo: &environment.ComponentPublishInfo{
					SparkLibraries: &environment.SparkLibraries{
						State: to.Ptr(environment.PublishStateSuccess),
					},
					SparkSettings: &environment.SparkSettings{
						State: to.Ptr(environment.PublishStateSuccess),
					},
				},
				EndTime:       to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2024-03-29T14:48:09.069Z"); return t }()),
				StartTime:     to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2024-03-29T14:17:09.069Z"); return t }()),
				State:         to.Ptr(environment.PublishStateSuccess),
				TargetVersion: to.Ptr("46838a80-5450-4414-bea0-40fb6f3e0c0d"),
			},
		},
	}

	testsuite.serverFactory.ItemsServer.GetEnvironment = func(ctx context.Context, workspaceID string, environmentID string, options *environment.ItemsClientGetEnvironmentOptions) (resp azfake.Responder[environment.ItemsClientGetEnvironmentResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		resp = azfake.Responder[environment.ItemsClientGetEnvironmentResponse]{}
		resp.SetResponse(http.StatusOK, environment.ItemsClientGetEnvironmentResponse{Environment: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	res, err := client.GetEnvironment(ctx, exampleWorkspaceID, exampleEnvironmentID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.Environment))
}

func (testsuite *FakeTestSuite) TestItems_UpdateEnvironment() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Update a environment example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var exampleUpdateEnvironmentRequest environment.UpdateEnvironmentRequest
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleEnvironmentID = "5b218778-e7a5-4d73-8187-f10824047715"
	exampleUpdateEnvironmentRequest = environment.UpdateEnvironmentRequest{
		Description: to.Ptr("A new description for environment."),
		DisplayName: to.Ptr("Environment_New_Name"),
	}

	exampleRes := environment.Environment{
		Type:        to.Ptr(environment.ItemTypeEnvironment),
		Description: to.Ptr("A new description for environment."),
		DisplayName: to.Ptr("Environment_New_Name"),
		ID:          to.Ptr("5b218778-e7a5-4d73-8187-f10824047715"),
		WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
	}

	testsuite.serverFactory.ItemsServer.UpdateEnvironment = func(ctx context.Context, workspaceID string, environmentID string, updateEnvironmentRequest environment.UpdateEnvironmentRequest, options *environment.ItemsClientUpdateEnvironmentOptions) (resp azfake.Responder[environment.ItemsClientUpdateEnvironmentResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().True(reflect.DeepEqual(exampleUpdateEnvironmentRequest, updateEnvironmentRequest))
		resp = azfake.Responder[environment.ItemsClientUpdateEnvironmentResponse]{}
		resp.SetResponse(http.StatusOK, environment.ItemsClientUpdateEnvironmentResponse{Environment: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	res, err := client.UpdateEnvironment(ctx, exampleWorkspaceID, exampleEnvironmentID, exampleUpdateEnvironmentRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.Environment))
}

func (testsuite *FakeTestSuite) TestItems_DeleteEnvironment() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Delete a environment example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleEnvironmentID = "5b218778-e7a5-4d73-8187-f10824047715"

	testsuite.serverFactory.ItemsServer.DeleteEnvironment = func(ctx context.Context, workspaceID string, environmentID string, options *environment.ItemsClientDeleteEnvironmentOptions) (resp azfake.Responder[environment.ItemsClientDeleteEnvironmentResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		resp = azfake.Responder[environment.ItemsClientDeleteEnvironmentResponse]{}
		resp.SetResponse(http.StatusOK, environment.ItemsClientDeleteEnvironmentResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	_, err = client.DeleteEnvironment(ctx, exampleWorkspaceID, exampleEnvironmentID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestItems_GetEnvironmentDefinition() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get a environment definition example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	exampleWorkspaceID = "6e335e92-a2a2-4b5a-970a-bd6a89fbb765"
	exampleEnvironmentID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"

	exampleRes := environment.DefinitionResponse{
		Definition: &environment.Definition{
			Parts: []environment.DefinitionPart{
				{
					Path:        to.Ptr("Libraries/CustomLibraries/samplelibrary.jar"),
					Payload:     to.Ptr("eyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("Libraries/CustomLibraries/samplepython.py"),
					Payload:     to.Ptr("FyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("Libraries/CustomLibraries/samplewheel-0.18.0-py2.py3-none-any.whl"),
					Payload:     to.Ptr("LyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("Libraries/CustomLibraries/sampleR.tar.gz"),
					Payload:     to.Ptr("ZyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("Libraries/PublicLibraries/environment.yml"),
					Payload:     to.Ptr("IyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("Setting/Sparkcompute.yml"),
					Payload:     to.Ptr("GyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr(".platform"),
					Payload:     to.Ptr("ZG90UGxhdGZvcm1CYXNlNjRTdHJpbmc"),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				}},
		},
	}

	testsuite.serverFactory.ItemsServer.BeginGetEnvironmentDefinition = func(ctx context.Context, workspaceID string, environmentID string, options *environment.ItemsClientBeginGetEnvironmentDefinitionOptions) (resp azfake.PollerResponder[environment.ItemsClientGetEnvironmentDefinitionResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		resp = azfake.PollerResponder[environment.ItemsClientGetEnvironmentDefinitionResponse]{}
		resp.SetTerminalResponse(http.StatusOK, environment.ItemsClientGetEnvironmentDefinitionResponse{DefinitionResponse: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	poller, err := client.BeginGetEnvironmentDefinition(ctx, exampleWorkspaceID, exampleEnvironmentID, &environment.ItemsClientBeginGetEnvironmentDefinitionOptions{Format: nil})
	testsuite.Require().NoError(err, "Failed to get result for example ")
	res, err := poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.DefinitionResponse))
}

func (testsuite *FakeTestSuite) TestItems_UpdateEnvironmentDefinition() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Update a environment definition example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var exampleUpdateEnvironmentDefinitionRequest environment.UpdateEnvironmentDefinitionRequest
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleEnvironmentID = "5b218778-e7a5-4d73-8187-f10824047715"
	exampleUpdateEnvironmentDefinitionRequest = environment.UpdateEnvironmentDefinitionRequest{
		Definition: &environment.Definition{
			Parts: []environment.DefinitionPart{
				{
					Path:        to.Ptr("Libraries/CustomLibraries/samplelibrary.jar"),
					Payload:     to.Ptr("eyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("Libraries/CustomLibraries/samplepython.py"),
					Payload:     to.Ptr("FyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("Libraries/CustomLibraries/samplewheel-0.18.0-py2.py3-none-any.whl"),
					Payload:     to.Ptr("LyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("Libraries/CustomLibraries/sampleR.tar.gz"),
					Payload:     to.Ptr("ZyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("Libraries/PublicLibraries/environment.yml"),
					Payload:     to.Ptr("IyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr("Setting/Sparkcompute.yml"),
					Payload:     to.Ptr("GyJuYmZvcm1hdCI6N.."),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr(".platform"),
					Payload:     to.Ptr("ZG90UGxhdGZvcm1CYXNlNjRTdHJpbmc"),
					PayloadType: to.Ptr(environment.PayloadTypeInlineBase64),
				}},
		},
	}

	testsuite.serverFactory.ItemsServer.BeginUpdateEnvironmentDefinition = func(ctx context.Context, workspaceID string, environmentID string, updateEnvironmentDefinitionRequest environment.UpdateEnvironmentDefinitionRequest, options *environment.ItemsClientBeginUpdateEnvironmentDefinitionOptions) (resp azfake.PollerResponder[environment.ItemsClientUpdateEnvironmentDefinitionResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().True(reflect.DeepEqual(exampleUpdateEnvironmentDefinitionRequest, updateEnvironmentDefinitionRequest))
		resp = azfake.PollerResponder[environment.ItemsClientUpdateEnvironmentDefinitionResponse]{}
		resp.SetTerminalResponse(http.StatusOK, environment.ItemsClientUpdateEnvironmentDefinitionResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	poller, err := client.BeginUpdateEnvironmentDefinition(ctx, exampleWorkspaceID, exampleEnvironmentID, exampleUpdateEnvironmentDefinitionRequest, &environment.ItemsClientBeginUpdateEnvironmentDefinitionOptions{UpdateMetadata: to.Ptr(true)})
	testsuite.Require().NoError(err, "Failed to get result for example ")
	_, err = poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")
}

func (testsuite *FakeTestSuite) TestItems_PublishEnvironment() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Publish environment example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var examplePreview bool
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"
	examplePreview = false

	exampleRes := environment.Properties{
		PublishDetails: &environment.PublishDetails{
			ComponentPublishInfo: &environment.ComponentPublishInfo{
				SparkLibraries: &environment.SparkLibraries{
					State: to.Ptr(environment.PublishStateRunning),
				},
				SparkSettings: &environment.SparkSettings{
					State: to.Ptr(environment.PublishStateRunning),
				},
			},
			StartTime:     to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2024-03-29T14:17:09.069Z"); return t }()),
			State:         to.Ptr(environment.PublishStateRunning),
			TargetVersion: to.Ptr("46838a80-5450-4414-bea0-40fb6f3e0c0d"),
		},
	}

	testsuite.serverFactory.ItemsServer.BeginPublishEnvironment = func(ctx context.Context, workspaceID string, environmentID string, preview bool, options *environment.ItemsClientBeginPublishEnvironmentOptions) (resp azfake.PollerResponder[environment.ItemsClientPublishEnvironmentResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().Equal(examplePreview, preview)
		resp = azfake.PollerResponder[environment.ItemsClientPublishEnvironmentResponse]{}
		resp.SetTerminalResponse(http.StatusOK, environment.ItemsClientPublishEnvironmentResponse{Properties: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	poller, err := client.BeginPublishEnvironment(ctx, exampleWorkspaceID, exampleEnvironmentID, examplePreview, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	res, err := poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.Properties))
}

func (testsuite *FakeTestSuite) TestItems_PublishEnvironmentPreview() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Publish environment example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	var examplePreview bool
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"
	examplePreview = true

	exampleRes := environment.Properties{
		PublishDetails: &environment.PublishDetails{
			ComponentPublishInfo: &environment.ComponentPublishInfo{
				SparkLibraries: &environment.SparkLibraries{
					State: to.Ptr(environment.PublishStateRunning),
				},
				SparkSettings: &environment.SparkSettings{
					State: to.Ptr(environment.PublishStateRunning),
				},
			},
			StartTime:     to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2024-03-29T14:17:09.069Z"); return t }()),
			State:         to.Ptr(environment.PublishStateRunning),
			TargetVersion: to.Ptr("46838a80-5450-4414-bea0-40fb6f3e0c0d"),
		},
	}

	testsuite.serverFactory.ItemsServer.PublishEnvironmentPreview = func(ctx context.Context, workspaceID string, environmentID string, preview bool, options *environment.ItemsClientPublishEnvironmentPreviewOptions) (resp azfake.Responder[environment.ItemsClientPublishEnvironmentPreviewResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		testsuite.Require().Equal(examplePreview, preview)
		resp = azfake.Responder[environment.ItemsClientPublishEnvironmentPreviewResponse]{}
		resp.SetResponse(http.StatusOK, environment.ItemsClientPublishEnvironmentPreviewResponse{Properties: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	res, err := client.PublishEnvironmentPreview(ctx, exampleWorkspaceID, exampleEnvironmentID, examplePreview, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.Properties))
}

func (testsuite *FakeTestSuite) TestItems_CancelPublishEnvironment() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Publish environment cancellation example"},
	})
	var exampleWorkspaceID string
	var exampleEnvironmentID string
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleEnvironmentID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"

	exampleRes := environment.Properties{
		PublishDetails: &environment.PublishDetails{
			ComponentPublishInfo: &environment.ComponentPublishInfo{
				SparkLibraries: &environment.SparkLibraries{
					State: to.Ptr(environment.PublishStateCancelled),
				},
				SparkSettings: &environment.SparkSettings{
					State: to.Ptr(environment.PublishStateCancelled),
				},
			},
			EndTime:       to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2024-03-29T14:48:18.069Z"); return t }()),
			StartTime:     to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2024-03-29T14:17:09.069Z"); return t }()),
			State:         to.Ptr(environment.PublishStateCancelled),
			TargetVersion: to.Ptr("d9d95b01-248f-4ef4-bd7e-9d3f1f6447be"),
		},
	}

	testsuite.serverFactory.ItemsServer.CancelPublishEnvironment = func(ctx context.Context, workspaceID string, environmentID string, options *environment.ItemsClientCancelPublishEnvironmentOptions) (resp azfake.Responder[environment.ItemsClientCancelPublishEnvironmentResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleEnvironmentID, environmentID)
		resp = azfake.Responder[environment.ItemsClientCancelPublishEnvironmentResponse]{}
		resp.SetResponse(http.StatusOK, environment.ItemsClientCancelPublishEnvironmentResponse{Properties: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	res, err := client.CancelPublishEnvironment(ctx, exampleWorkspaceID, exampleEnvironmentID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.Properties))
}
