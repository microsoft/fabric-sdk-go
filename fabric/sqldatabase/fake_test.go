// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License. See LICENSE in the project root for license information.
// Code generated by Microsoft (R) AutoRest Code Generator.
// Changes may cause incorrect behavior and will be lost if the code is regenerated.
// SPDX-License-Identifier: MIT

package sqldatabase_test

import (
	"context"
	"net/http"
	"testing"

	"github.com/Azure/azure-sdk-for-go/sdk/azcore"

	azfake "github.com/Azure/azure-sdk-for-go/sdk/azcore/fake"
	"github.com/Azure/azure-sdk-for-go/sdk/azcore/runtime"
	"github.com/Azure/azure-sdk-for-go/sdk/azcore/to"

	"reflect"
	"time"

	"github.com/stretchr/testify/suite"

	"github.com/microsoft/fabric-sdk-go/fabric"
	"github.com/microsoft/fabric-sdk-go/fabric/sqldatabase"
	"github.com/microsoft/fabric-sdk-go/fabric/sqldatabase/fake"
)

var err error

type FakeTestSuite struct {
	suite.Suite

	ctx  context.Context
	cred azcore.TokenCredential

	serverFactory *fake.ServerFactory
	clientFactory *sqldatabase.ClientFactory
}

func (testsuite *FakeTestSuite) SetupSuite() {
	testsuite.ctx = context.Background()
	testsuite.cred = &azfake.TokenCredential{}

	testsuite.serverFactory = &fake.ServerFactory{}
	testsuite.clientFactory, err = sqldatabase.NewClientFactory(testsuite.cred, nil, &fabric.ClientOptions{
		ClientOptions: azcore.ClientOptions{
			Transport: fake.NewServerFactoryTransport(testsuite.serverFactory),
		},
	})
	testsuite.Require().NoError(err, "Failed to create client factory")
}

func TestFakeTest(t *testing.T) {
	suite.Run(t, new(FakeTestSuite))
}

func (testsuite *FakeTestSuite) TestItems_ListSQLDatabases() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"List SQLDatabases in workspace example"},
	})
	var exampleWorkspaceID string
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"

	exampleRes := sqldatabase.SQLDatabases{
		Value: []sqldatabase.SQLDatabase{
			{
				Type:        to.Ptr(sqldatabase.ItemTypeSQLDatabase),
				Description: to.Ptr("A SQLDatabase description."),
				DisplayName: to.Ptr("SQLDatabase1"),
				ID:          to.Ptr("3546052c-ae64-4526-b1a8-52af7761426f"),
				WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
				Properties: &sqldatabase.Properties{
					ConnectionString: to.Ptr("Data Source=fvzeldvqgvce3b2hxvbg4hnjqu-nowrtjcsie2e3ny6v4ojbd3esa.database.fabric.microsoft.com,1433;Initial Catalog=SQLDatabase1-45c6e7cf-89b1-4a69-b4e1-5495271c7e45;MultipleActiveResultSets=False;Connect Timeout=30;Encrypt=True;TrustServerCertificate=False"),
					DatabaseName:     to.Ptr("SQLDatabase1-45c6e7cf-89b1-4a69-b4e1-5495271c7e45"),
					ServerFqdn:       to.Ptr("fvzeldvqgvce3b2hxvbg4hnjqu-nowrtjcsie2e3ny6v4ojbd3esa.database.fabric.microsoft.com,1433"),
				},
			},
			{
				Type:        to.Ptr(sqldatabase.ItemTypeSQLDatabase),
				Description: to.Ptr("A SQLDatabase description."),
				DisplayName: to.Ptr("SQLDatabase2"),
				ID:          to.Ptr("f697fb63-abd4-4399-9548-be7e3c3c0dac"),
				WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
				Properties: &sqldatabase.Properties{
					ConnectionString: to.Ptr("Data Source=x6eps4xrq2xudenlfv6naeo3i4-cfqmbux5lgvuzcoypz4jiwkqxq.database.fabric.microsoft.com,1433;Initial Catalog=SQLDatabase2-85fdf021-23ed-4307-be63-92e553a22d54;MultipleActiveResultSets=False;Connect Timeout=30;Encrypt=True;TrustServerCertificate=False"),
					DatabaseName:     to.Ptr("SQLDatabase2-85fdf021-23ed-4307-be63-92e553a22d54"),
					ServerFqdn:       to.Ptr("x6eps4xrq2xudenlfv6naeo3i4-cfqmbux5lgvuzcoypz4jiwkqxq.database.fabric.microsoft.com,1433"),
				},
			}},
	}

	testsuite.serverFactory.ItemsServer.NewListSQLDatabasesPager = func(workspaceID string, options *sqldatabase.ItemsClientListSQLDatabasesOptions) (resp azfake.PagerResponder[sqldatabase.ItemsClientListSQLDatabasesResponse]) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		resp = azfake.PagerResponder[sqldatabase.ItemsClientListSQLDatabasesResponse]{}
		resp.AddPage(http.StatusOK, sqldatabase.ItemsClientListSQLDatabasesResponse{SQLDatabases: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	pager := client.NewListSQLDatabasesPager(exampleWorkspaceID, &sqldatabase.ItemsClientListSQLDatabasesOptions{ContinuationToken: nil})
	for pager.More() {
		nextResult, err := pager.NextPage(ctx)
		testsuite.Require().NoError(err, "Failed to advance page for example ")
		testsuite.Require().True(reflect.DeepEqual(exampleRes, nextResult.SQLDatabases))
		if err == nil {
			break
		}
	}
}

func (testsuite *FakeTestSuite) TestItems_CreateSQLDatabase() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Create a SQLDatabase example"},
	})
	var exampleWorkspaceID string
	var exampleCreateSQLDatabaseRequest sqldatabase.CreateSQLDatabaseRequest
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleCreateSQLDatabaseRequest = sqldatabase.CreateSQLDatabaseRequest{
		Description: to.Ptr("A SQLDatabase description."),
		DisplayName: to.Ptr("SQLDatabase 1"),
	}

	testsuite.serverFactory.ItemsServer.BeginCreateSQLDatabase = func(ctx context.Context, workspaceID string, createSQLDatabaseRequest sqldatabase.CreateSQLDatabaseRequest, options *sqldatabase.ItemsClientBeginCreateSQLDatabaseOptions) (resp azfake.PollerResponder[sqldatabase.ItemsClientCreateSQLDatabaseResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().True(reflect.DeepEqual(exampleCreateSQLDatabaseRequest, createSQLDatabaseRequest))
		resp = azfake.PollerResponder[sqldatabase.ItemsClientCreateSQLDatabaseResponse]{}
		resp.SetTerminalResponse(http.StatusCreated, sqldatabase.ItemsClientCreateSQLDatabaseResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	poller, err := client.BeginCreateSQLDatabase(ctx, exampleWorkspaceID, exampleCreateSQLDatabaseRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	_, err = poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")

	// From example
	ctx = runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Create a SQLDatabase with definition example"},
	})
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleCreateSQLDatabaseRequest = sqldatabase.CreateSQLDatabaseRequest{
		Description: to.Ptr("A SQLDatabase description."),
		Definition: &sqldatabase.Definition{
			Parts: []sqldatabase.PublicDefinitionPart{
				{
					Path:        to.Ptr("definition.dacpac"),
					Payload:     to.Ptr("ew0KICAibGFrZWhvdXNlSWQiOiAiYjliNWQzNmYtNDQ0NS00MDNiLWFjODctMDE2YjFjZDIwMjExIg0KfQ=="),
					PayloadType: to.Ptr(sqldatabase.PayloadTypeInlineBase64),
				}},
		},
		DisplayName: to.Ptr("SQLDatabase1"),
	}

	testsuite.serverFactory.ItemsServer.BeginCreateSQLDatabase = func(ctx context.Context, workspaceID string, createSQLDatabaseRequest sqldatabase.CreateSQLDatabaseRequest, options *sqldatabase.ItemsClientBeginCreateSQLDatabaseOptions) (resp azfake.PollerResponder[sqldatabase.ItemsClientCreateSQLDatabaseResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().True(reflect.DeepEqual(exampleCreateSQLDatabaseRequest, createSQLDatabaseRequest))
		resp = azfake.PollerResponder[sqldatabase.ItemsClientCreateSQLDatabaseResponse]{}
		resp.SetTerminalResponse(http.StatusCreated, sqldatabase.ItemsClientCreateSQLDatabaseResponse{}, nil)
		return
	}

	poller, err = client.BeginCreateSQLDatabase(ctx, exampleWorkspaceID, exampleCreateSQLDatabaseRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	_, err = poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")

	// From example
	ctx = runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Create a SQLDatabase with payload example"},
	})
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleCreateSQLDatabaseRequest = sqldatabase.CreateSQLDatabaseRequest{
		Description: to.Ptr("A SQLDatabase description."),
		CreationPayload: &sqldatabase.RestoreSQLDatabaseCreationPayload{
			CreationMode:       to.Ptr(sqldatabase.CreationModeRestore),
			RestorePointInTime: to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2024-12-01T00:00:00.000Z"); return t }()),
			SourceDatabaseReference: &sqldatabase.ItemReferenceByID{
				ReferenceType: to.Ptr(sqldatabase.ItemReferenceTypeByID),
				ItemID:        to.Ptr("d96de2f4-7dd1-45ad-9ff6-37a2d6aa9861"),
				WorkspaceID:   to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
			},
		},
		DisplayName: to.Ptr("SQLDatabase1"),
	}

	testsuite.serverFactory.ItemsServer.BeginCreateSQLDatabase = func(ctx context.Context, workspaceID string, createSQLDatabaseRequest sqldatabase.CreateSQLDatabaseRequest, options *sqldatabase.ItemsClientBeginCreateSQLDatabaseOptions) (resp azfake.PollerResponder[sqldatabase.ItemsClientCreateSQLDatabaseResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().True(reflect.DeepEqual(exampleCreateSQLDatabaseRequest, createSQLDatabaseRequest))
		resp = azfake.PollerResponder[sqldatabase.ItemsClientCreateSQLDatabaseResponse]{}
		resp.SetTerminalResponse(http.StatusCreated, sqldatabase.ItemsClientCreateSQLDatabaseResponse{}, nil)
		return
	}

	poller, err = client.BeginCreateSQLDatabase(ctx, exampleWorkspaceID, exampleCreateSQLDatabaseRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	_, err = poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")
}

func (testsuite *FakeTestSuite) TestItems_GetSQLDatabase() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get a SQLDatabase example"},
	})
	var exampleWorkspaceID string
	var exampleSqlDatabaseID string
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleSqlDatabaseID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"

	exampleRes := sqldatabase.SQLDatabase{
		Type:        to.Ptr(sqldatabase.ItemTypeSQLDatabase),
		Description: to.Ptr("A SQLDatabase description."),
		DisplayName: to.Ptr("SQLDatabase1"),
		ID:          to.Ptr("5b218778-e7a5-4d73-8187-f10824047715"),
		WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
		Properties: &sqldatabase.Properties{
			BackupRetentionDays:  to.Ptr[int32](7),
			ConnectionString:     to.Ptr("Data Source=fvzeldvqgvce3b2hxvbg4hnjqu-nowrtjcsie2e3ny6v4ojbd3esa.database.fabric.microsoft.com,1433;Initial Catalog=SQLDatabase1-45c6e7cf-89b1-4a69-b4e1-5495271c7e45;MultipleActiveResultSets=False;Connect Timeout=30;Encrypt=True;TrustServerCertificate=False"),
			DatabaseName:         to.Ptr("SQLDatabase1-45c6e7cf-89b1-4a69-b4e1-5495271c7e45"),
			EarliestRestorePoint: to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2024-12-01T00:00:00.000Z"); return t }()),
			LatestRestorePoint:   to.Ptr(func() time.Time { t, _ := time.Parse(time.RFC3339Nano, "2024-12-02T00:00:00.000Z"); return t }()),
			ServerFqdn:           to.Ptr("fvzeldvqgvce3b2hxvbg4hnjqu-nowrtjcsie2e3ny6v4ojbd3esa.database.fabric.microsoft.com,1433"),
		},
	}

	testsuite.serverFactory.ItemsServer.GetSQLDatabase = func(ctx context.Context, workspaceID string, sqlDatabaseID string, options *sqldatabase.ItemsClientGetSQLDatabaseOptions) (resp azfake.Responder[sqldatabase.ItemsClientGetSQLDatabaseResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleSqlDatabaseID, sqlDatabaseID)
		resp = azfake.Responder[sqldatabase.ItemsClientGetSQLDatabaseResponse]{}
		resp.SetResponse(http.StatusOK, sqldatabase.ItemsClientGetSQLDatabaseResponse{SQLDatabase: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	res, err := client.GetSQLDatabase(ctx, exampleWorkspaceID, exampleSqlDatabaseID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.SQLDatabase))
}

func (testsuite *FakeTestSuite) TestItems_UpdateSQLDatabase() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Update a SQLDatabase example"},
	})
	var exampleWorkspaceID string
	var exampleSqlDatabaseID string
	var exampleUpdateSQLDatabaseRequest sqldatabase.UpdateSQLDatabaseRequest
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleSqlDatabaseID = "5b218778-e7a5-4d73-8187-f10824047715"
	exampleUpdateSQLDatabaseRequest = sqldatabase.UpdateSQLDatabaseRequest{
		Description: to.Ptr("SQLDatabase's New description"),
	}

	exampleRes := sqldatabase.SQLDatabase{
		Type:        to.Ptr(sqldatabase.ItemTypeSQLDatabase),
		Description: to.Ptr("SQLDatabase's New description"),
		DisplayName: to.Ptr("SQLDatabase's name"),
		ID:          to.Ptr("5b218778-e7a5-4d73-8187-f10824047715"),
		WorkspaceID: to.Ptr("cfafbeb1-8037-4d0c-896e-a46fb27ff229"),
	}

	testsuite.serverFactory.ItemsServer.UpdateSQLDatabase = func(ctx context.Context, workspaceID string, sqlDatabaseID string, updateSQLDatabaseRequest sqldatabase.UpdateSQLDatabaseRequest, options *sqldatabase.ItemsClientUpdateSQLDatabaseOptions) (resp azfake.Responder[sqldatabase.ItemsClientUpdateSQLDatabaseResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleSqlDatabaseID, sqlDatabaseID)
		testsuite.Require().True(reflect.DeepEqual(exampleUpdateSQLDatabaseRequest, updateSQLDatabaseRequest))
		resp = azfake.Responder[sqldatabase.ItemsClientUpdateSQLDatabaseResponse]{}
		resp.SetResponse(http.StatusOK, sqldatabase.ItemsClientUpdateSQLDatabaseResponse{SQLDatabase: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	res, err := client.UpdateSQLDatabase(ctx, exampleWorkspaceID, exampleSqlDatabaseID, exampleUpdateSQLDatabaseRequest, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.SQLDatabase))
}

func (testsuite *FakeTestSuite) TestItems_DeleteSQLDatabase() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Delete a SQLDatabase example"},
	})
	var exampleWorkspaceID string
	var exampleSqlDatabaseID string
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleSqlDatabaseID = "5b218778-e7a5-4d73-8187-f10824047715"

	testsuite.serverFactory.ItemsServer.DeleteSQLDatabase = func(ctx context.Context, workspaceID string, sqlDatabaseID string, options *sqldatabase.ItemsClientDeleteSQLDatabaseOptions) (resp azfake.Responder[sqldatabase.ItemsClientDeleteSQLDatabaseResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleSqlDatabaseID, sqlDatabaseID)
		resp = azfake.Responder[sqldatabase.ItemsClientDeleteSQLDatabaseResponse]{}
		resp.SetResponse(http.StatusOK, sqldatabase.ItemsClientDeleteSQLDatabaseResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	_, err = client.DeleteSQLDatabase(ctx, exampleWorkspaceID, exampleSqlDatabaseID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestItems_GetSQLDatabaseDefinition() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Get a Digital Twin Builder Flow public definition example"},
	})
	var exampleWorkspaceID string
	var exampleSqlDatabaseID string
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleSqlDatabaseID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"

	exampleRes := sqldatabase.DefinitionResponse{
		Definition: &sqldatabase.Definition{
			Parts: []sqldatabase.PublicDefinitionPart{
				{
					Path:        to.Ptr("definition.dacpac"),
					Payload:     to.Ptr("ew0KICAibGFrZWhvdXNlSWQiOiAiYjliNWQzNmYtNDQ0NS00MDNiLWFjODctMDE2YjFjZDIwMjExIg0KfQ=="),
					PayloadType: to.Ptr(sqldatabase.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr(".platform"),
					Payload:     to.Ptr("ZG90UGxhdGZvcm1CYXNlNjRTdHJpbmc="),
					PayloadType: to.Ptr(sqldatabase.PayloadTypeInlineBase64),
				}},
		},
	}

	testsuite.serverFactory.ItemsServer.BeginGetSQLDatabaseDefinition = func(ctx context.Context, workspaceID string, sqlDatabaseID string, options *sqldatabase.ItemsClientBeginGetSQLDatabaseDefinitionOptions) (resp azfake.PollerResponder[sqldatabase.ItemsClientGetSQLDatabaseDefinitionResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleSqlDatabaseID, sqlDatabaseID)
		resp = azfake.PollerResponder[sqldatabase.ItemsClientGetSQLDatabaseDefinitionResponse]{}
		resp.SetTerminalResponse(http.StatusOK, sqldatabase.ItemsClientGetSQLDatabaseDefinitionResponse{DefinitionResponse: exampleRes}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	poller, err := client.BeginGetSQLDatabaseDefinition(ctx, exampleWorkspaceID, exampleSqlDatabaseID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
	res, err := poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")
	testsuite.Require().True(reflect.DeepEqual(exampleRes, res.DefinitionResponse))
}

func (testsuite *FakeTestSuite) TestItems_UpdateSQLDatabasesDefinition() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Update a SQL database public definition example"},
	})
	var exampleWorkspaceID string
	var exampleSqlDatabaseID string
	var exampleUpdateSQLDatabaseDefinitionRequest sqldatabase.UpdateSQLDatabaseDefinitionRequest
	exampleWorkspaceID = "cfafbeb1-8037-4d0c-896e-a46fb27ff229"
	exampleSqlDatabaseID = "5b218778-e7a5-4d73-8187-f10824047715"
	exampleUpdateSQLDatabaseDefinitionRequest = sqldatabase.UpdateSQLDatabaseDefinitionRequest{
		Definition: &sqldatabase.Definition{
			Parts: []sqldatabase.PublicDefinitionPart{
				{
					Path:        to.Ptr("definition.dacpac"),
					Payload:     to.Ptr("ew0KICAibGFrZWhvdXNlSWQiOiAiYjliNWQzNmYtNDQ0NS00MDNiLWFjODctMDE2YjFjZDIwMjExIg0KfQ=="),
					PayloadType: to.Ptr(sqldatabase.PayloadTypeInlineBase64),
				},
				{
					Path:        to.Ptr(".platform"),
					Payload:     to.Ptr("ZG90UGxhdGZvcm1CYXNlNjRTdHJpbmc="),
					PayloadType: to.Ptr(sqldatabase.PayloadTypeInlineBase64),
				}},
		},
	}

	testsuite.serverFactory.ItemsServer.BeginUpdateSQLDatabasesDefinition = func(ctx context.Context, workspaceID string, sqlDatabaseID string, updateSQLDatabaseDefinitionRequest sqldatabase.UpdateSQLDatabaseDefinitionRequest, options *sqldatabase.ItemsClientBeginUpdateSQLDatabasesDefinitionOptions) (resp azfake.PollerResponder[sqldatabase.ItemsClientUpdateSQLDatabasesDefinitionResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleSqlDatabaseID, sqlDatabaseID)
		testsuite.Require().True(reflect.DeepEqual(exampleUpdateSQLDatabaseDefinitionRequest, updateSQLDatabaseDefinitionRequest))
		resp = azfake.PollerResponder[sqldatabase.ItemsClientUpdateSQLDatabasesDefinitionResponse]{}
		resp.SetTerminalResponse(http.StatusOK, sqldatabase.ItemsClientUpdateSQLDatabasesDefinitionResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewItemsClient()
	poller, err := client.BeginUpdateSQLDatabasesDefinition(ctx, exampleWorkspaceID, exampleSqlDatabaseID, exampleUpdateSQLDatabaseDefinitionRequest, &sqldatabase.ItemsClientBeginUpdateSQLDatabasesDefinitionOptions{UpdateMetadata: to.Ptr(true)})
	testsuite.Require().NoError(err, "Failed to get result for example ")
	_, err = poller.PollUntilDone(ctx, nil)
	testsuite.Require().NoError(err, "Failed to get LRO result for example ")
}

func (testsuite *FakeTestSuite) TestSQLDatabase_StartMirroring() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Start mirroring example"},
	})
	var exampleWorkspaceID string
	var exampleSqlDatabaseID string
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleSqlDatabaseID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"

	testsuite.serverFactory.Server.StartMirroring = func(ctx context.Context, workspaceID string, sqlDatabaseID string, options *sqldatabase.ClientStartMirroringOptions) (resp azfake.Responder[sqldatabase.ClientStartMirroringResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleSqlDatabaseID, sqlDatabaseID)
		resp = azfake.Responder[sqldatabase.ClientStartMirroringResponse]{}
		resp.SetResponse(http.StatusOK, sqldatabase.ClientStartMirroringResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewClient()
	_, err = client.StartMirroring(ctx, exampleWorkspaceID, exampleSqlDatabaseID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}

func (testsuite *FakeTestSuite) TestSQLDatabase_StopMirroring() {
	// From example
	ctx := runtime.WithHTTPHeader(testsuite.ctx, map[string][]string{
		"example-id": {"Stop mirroring example"},
	})
	var exampleWorkspaceID string
	var exampleSqlDatabaseID string
	exampleWorkspaceID = "f089354e-8366-4e18-aea3-4cb4a3a50b48"
	exampleSqlDatabaseID = "41ce06d1-d81b-4ea0-bc6d-2ce3dd2f8e87"

	testsuite.serverFactory.Server.StopMirroring = func(ctx context.Context, workspaceID string, sqlDatabaseID string, options *sqldatabase.ClientStopMirroringOptions) (resp azfake.Responder[sqldatabase.ClientStopMirroringResponse], errResp azfake.ErrorResponder) {
		testsuite.Require().Equal(exampleWorkspaceID, workspaceID)
		testsuite.Require().Equal(exampleSqlDatabaseID, sqlDatabaseID)
		resp = azfake.Responder[sqldatabase.ClientStopMirroringResponse]{}
		resp.SetResponse(http.StatusOK, sqldatabase.ClientStopMirroringResponse{}, nil)
		return
	}

	client := testsuite.clientFactory.NewClient()
	_, err = client.StopMirroring(ctx, exampleWorkspaceID, exampleSqlDatabaseID, nil)
	testsuite.Require().NoError(err, "Failed to get result for example ")
}
